<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>07 Llamaindex   Index | çŸ¥è¯†åº“</title><meta name="description" content="æ¶µç›–Javaã€Springã€Vueã€Node.jsç­‰æŠ€æœ¯çŸ¥è¯†">
    <link rel="stylesheet" href="/wiki/assets/css/styles.dd0ba6d4.css">
    <link rel="preload" href="/wiki/assets/js/runtime~app.d314b252.js" as="script"><link rel="preload" href="/wiki/assets/css/styles.dd0ba6d4.css" as="style"><link rel="preload" href="/wiki/assets/js/768.e6d4205d.js" as="script"><link rel="preload" href="/wiki/assets/js/app.7c5dba0b.js" as="script">
    <link rel="prefetch" href="/wiki/assets/js/solution_smart-marketing_index.html.066d2d5f.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_05-rag-embeddings.html.5b793696.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_high-availability_index.html.1ef390b5.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_react_index.html.48c1e14e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_02-prompt.html.e84448e0.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_08-langchain.html.0b85e079.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_06-assistants-api.html.aee72ff3.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_aiops_index.html.95469b02.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_07-llamaindex.html.62de5a73.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_swift_index.html.0fd2295e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_03-func-call.html.80139b7e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_09-llm-tools.html.34caf241.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_07-semantic-kernel.bak.html.91e47126.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_embedded_index.html.5d403469.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_04-ai-programming.html.b02837a6.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_nodejs_index.html.5a23d5c1.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_python_index.html.b138fbf3.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_spring-boot_index.html.75c329c5.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_java_jdk-changes_index.html.1bf5685c.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_tools.html.32acc61a.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_01-intro.html.be7abb56.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_r_index.html.01fc91b5.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_vue_index.html.7ae1fc67.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_java_concurrency_index.html.e362b849.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_llm-faq.html.f09e7381.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_04-ai-programming-practice.html.fcc21d00.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_java_advanced_index.html.71c33c5c.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_spring-cloud_index.html.1230cde8.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_message-queue_index.html.604a378b.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_big-data_index.html.d9a7770e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_database_index.html.943dfb75.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_java_basic_index.html.e6c1018a.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_ml_index.html.f03756d1.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_ChatALL.html.e7d49092.js" as="script"><link rel="prefetch" href="/wiki/assets/js/interview_java_collections_index.html.8d492322.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_rl_index.html.adc2eeab.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_implementation.html.a3ef2295.js" as="script"><link rel="prefetch" href="/wiki/assets/js/get-started.html.776b8f4a.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_kubecost-installation.html.f28b5b94.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_risk-trends.html.66e797bc.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_10-agent.html.5c170d47.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_case-studies.html.e283feaa.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_index.html.aac8183e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/index.html.599be039.js" as="script"><link rel="prefetch" href="/wiki/assets/js/tutorial_llm_index.html.6b9b5f38.js" as="script"><link rel="prefetch" href="/wiki/assets/js/solution_finops_concept.html.6e93951e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/404.html.66d54fed.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/wiki/"><img class="vp-site-logo" src="/wiki/logo/logo.svg" alt="çŸ¥è¯†åº“"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">çŸ¥è¯†åº“</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/wiki/" aria-label="é¦–é¡µ"><!--[--><!--[--><!--]--><!--]-->é¦–é¡µ<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/wiki/get-started.html" aria-label="å¼€å§‹é˜…è¯»"><!--[--><!--[--><!--]--><!--]-->å¼€å§‹é˜…è¯»<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/basic/" aria-label="JavaåŸºç¡€"><!--[--><!--[--><!--]--><!--]-->JavaåŸºç¡€<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/advanced/" aria-label="Javaé«˜çº§"><!--[--><!--[--><!--]--><!--]-->Javaé«˜çº§<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/collections/" aria-label="Javaé›†åˆè¯¦è§£"><!--[--><!--[--><!--]--><!--]-->Javaé›†åˆè¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/concurrency/" aria-label="Javaå¤šçº¿ç¨‹è¯¦è§£"><!--[--><!--[--><!--]--><!--]-->Javaå¤šçº¿ç¨‹è¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/jdk-changes/" aria-label="JDKç‰ˆæœ¬å˜åŒ–è¯¦è§£"><!--[--><!--[--><!--]--><!--]-->JDKç‰ˆæœ¬å˜åŒ–è¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/spring-boot/" aria-label="Spring Boot"><!--[--><!--[--><!--]--><!--]-->Spring Boot<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/spring-cloud/" aria-label="Spring Cloud"><!--[--><!--[--><!--]--><!--]-->Spring Cloud<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="æŠ€æœ¯æ•™ç¨‹"><span class="title">æŠ€æœ¯æ•™ç¨‹</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="æŠ€æœ¯æ•™ç¨‹"><span class="title">æŠ€æœ¯æ•™ç¨‹</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/wiki/tutorial/llm/" aria-label="LLM"><!--[--><!--[--><!--]--><!--]-->LLM<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="è§£å†³æ–¹æ¡ˆ"><span class="title">è§£å†³æ–¹æ¡ˆ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="è§£å†³æ–¹æ¡ˆ"><span class="title">è§£å†³æ–¹æ¡ˆ</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/aiops/" aria-label="AIOps"><!--[--><!--[--><!--]--><!--]-->AIOps<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/finops/" aria-label="FinOps"><!--[--><!--[--><!--]--><!--]-->FinOps<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/high-availability/" aria-label="é«˜å¯ç”¨æ¶æ„"><!--[--><!--[--><!--]--><!--]-->é«˜å¯ç”¨æ¶æ„<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/smart-marketing/" aria-label="æ™ºèƒ½è¥é”€"><!--[--><!--[--><!--]--><!--]-->æ™ºèƒ½è¥é”€<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/wiki/" aria-label="é¦–é¡µ"><!--[--><!--[--><!--]--><!--]-->é¦–é¡µ<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/wiki/get-started.html" aria-label="å¼€å§‹é˜…è¯»"><!--[--><!--[--><!--]--><!--]-->å¼€å§‹é˜…è¯»<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/basic/" aria-label="JavaåŸºç¡€"><!--[--><!--[--><!--]--><!--]-->JavaåŸºç¡€<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/advanced/" aria-label="Javaé«˜çº§"><!--[--><!--[--><!--]--><!--]-->Javaé«˜çº§<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/collections/" aria-label="Javaé›†åˆè¯¦è§£"><!--[--><!--[--><!--]--><!--]-->Javaé›†åˆè¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/concurrency/" aria-label="Javaå¤šçº¿ç¨‹è¯¦è§£"><!--[--><!--[--><!--]--><!--]-->Javaå¤šçº¿ç¨‹è¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/java/jdk-changes/" aria-label="JDKç‰ˆæœ¬å˜åŒ–è¯¦è§£"><!--[--><!--[--><!--]--><!--]-->JDKç‰ˆæœ¬å˜åŒ–è¯¦è§£<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/spring-boot/" aria-label="Spring Boot"><!--[--><!--[--><!--]--><!--]-->Spring Boot<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/interview/spring-cloud/" aria-label="Spring Cloud"><!--[--><!--[--><!--]--><!--]-->Spring Cloud<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="æŠ€æœ¯æ•™ç¨‹"><span class="title">æŠ€æœ¯æ•™ç¨‹</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="æŠ€æœ¯æ•™ç¨‹"><span class="title">æŠ€æœ¯æ•™ç¨‹</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/wiki/tutorial/llm/" aria-label="LLM"><!--[--><!--[--><!--]--><!--]-->LLM<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="è§£å†³æ–¹æ¡ˆ"><span class="title">è§£å†³æ–¹æ¡ˆ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="è§£å†³æ–¹æ¡ˆ"><span class="title">è§£å†³æ–¹æ¡ˆ</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/aiops/" aria-label="AIOps"><!--[--><!--[--><!--]--><!--]-->AIOps<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/finops/" aria-label="FinOps"><!--[--><!--[--><!--]--><!--]-->FinOps<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/high-availability/" aria-label="é«˜å¯ç”¨æ¶æ„"><!--[--><!--[--><!--]--><!--]-->é«˜å¯ç”¨æ¶æ„<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/wiki/solution/smart-marketing/" aria-label="æ™ºèƒ½è¥é”€"><!--[--><!--[--><!--]--><!--]-->æ™ºèƒ½è¥é”€<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item vp-sidebar-heading" href="/wiki/tutorial/llm/" aria-label="LLMå­¦ä¹ æ•™ç¨‹"><!--[--><!--[--><!--]--><!--]-->LLMå­¦ä¹ æ•™ç¨‹<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="_07-llamaindex-index" tabindex="-1"><a class="header-anchor" href="#_07-llamaindex-index"><span>07 Llamaindex Index</span></a></h1><h1 id="ğŸ’¡-è¿™èŠ‚è¯¾ä¼šå¸¦ç»™ä½ " tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-è¿™èŠ‚è¯¾ä¼šå¸¦ç»™ä½ "><span>ğŸ’¡ è¿™èŠ‚è¯¾ä¼šå¸¦ç»™ä½ </span></a></h1><ol><li>LlamaIndex çš„ç‰¹ç‚¹å’ŒåŸºæœ¬ç”¨æ³•</li><li>äº†è§£ LlamaIndex å†…ç½®çš„å·¥å…·</li><li>å¦‚ä½•ç”¨å¥½ SDK ç®€åŒ–åŸºäº LLM çš„åº”ç”¨å¼€å‘</li></ol><p>å¼€å§‹ä¸Šè¯¾ï¼</p><h2 id="ğŸ“-è¿™èŠ‚è¯¾æ€ä¹ˆå­¦" tabindex="-1"><a class="header-anchor" href="#ğŸ“-è¿™èŠ‚è¯¾æ€ä¹ˆå­¦"><span>ğŸ“ è¿™èŠ‚è¯¾æ€ä¹ˆå­¦</span></a></h2><p>ä»£ç èƒ½åŠ›è¦æ±‚ï¼š<strong>ä¸­é«˜</strong>ï¼ŒAI/æ•°å­¦åŸºç¡€è¦æ±‚ï¼š<strong>æ— </strong></p><ol><li>æœ‰ç¼–ç¨‹ä¸è½¯ä»¶å·¥ç¨‹åŸºç¡€çš„åŒå­¦ <ul><li>å…³æ³¨æ¥å£ä¸å®ç°ç»†èŠ‚ã€é«˜çº§æŠ€å·§ã€å¯æ‰©å±•æ€§</li></ul></li><li>æ²¡æœ‰ç¼–ç¨‹æˆ–è½¯ä»¶å·¥ç¨‹åŸºç¡€çš„åŒå­¦ <ul><li>å°½é‡ç†è§£ SDK çš„æ¦‚å¿µå’Œä»·å€¼ï¼Œå°è¯•ä½“ä¼šä½¿ç”¨ SDK å‰åçš„å·®åˆ«ä¸æ„ä¹‰</li></ul></li></ol><h2 id="_1ã€å¤§è¯­è¨€æ¨¡å‹å¼€å‘æ¡†æ¶çš„ä»·å€¼æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1ã€å¤§è¯­è¨€æ¨¡å‹å¼€å‘æ¡†æ¶çš„ä»·å€¼æ˜¯ä»€ä¹ˆ"><span>1ã€å¤§è¯­è¨€æ¨¡å‹å¼€å‘æ¡†æ¶çš„ä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></h2><p><em>SDKï¼šSoftware Development Kitï¼Œå®ƒæ˜¯ä¸€ç»„è½¯ä»¶å·¥å…·å’Œèµ„æºçš„é›†åˆï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…åˆ›å»ºã€æµ‹è¯•ã€éƒ¨ç½²å’Œç»´æŠ¤åº”ç”¨ç¨‹åºæˆ–è½¯ä»¶ã€‚</em></p><p>æ‰€æœ‰å¼€å‘æ¡†æ¶ï¼ˆSDKï¼‰çš„æ ¸å¿ƒä»·å€¼ï¼Œéƒ½æ˜¯é™ä½å¼€å‘ã€ç»´æŠ¤æˆæœ¬ã€‚</p><p>å¤§è¯­è¨€æ¨¡å‹å¼€å‘æ¡†æ¶çš„ä»·å€¼ï¼Œæ˜¯è®©å¼€å‘è€…å¯ä»¥æ›´æ–¹ä¾¿åœ°å¼€å‘åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„åº”ç”¨ã€‚ä¸»è¦æä¾›ä¸¤ç±»å¸®åŠ©ï¼š</p><ol><li>ç¬¬ä¸‰æ–¹èƒ½åŠ›æŠ½è±¡ã€‚æ¯”å¦‚ LLMã€å‘é‡æ•°æ®åº“ã€æœç´¢æ¥å£ç­‰</li><li>å¸¸ç”¨å·¥å…·ã€æ–¹æ¡ˆå°è£…</li><li>åº•å±‚å®ç°å°è£…ã€‚æ¯”å¦‚æµå¼æ¥å£ã€è¶…æ—¶é‡è¿ã€å¼‚æ­¥ä¸å¹¶è¡Œç­‰</li></ol><p>å¥½çš„å¼€å‘æ¡†æ¶ï¼Œéœ€è¦å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li>å¯é æ€§ã€é²æ£’æ€§é«˜</li><li>å¯ç»´æŠ¤æ€§é«˜</li><li>å¯æ‰©å±•æ€§é«˜</li><li>å­¦ä¹ æˆæœ¬ä½</li></ol><p>ä¸¾äº›é€šä¿—çš„ä¾‹å­ï¼š</p><ul><li>ä¸å¤–éƒ¨åŠŸèƒ½è§£ä¾èµ– <ul><li>æ¯”å¦‚å¯ä»¥éšæ„æ›´æ¢ LLM è€Œä¸ç”¨å¤§é‡é‡æ„ä»£ç </li><li>æ›´æ¢ä¸‰æ–¹å·¥å…·ä¹ŸåŒç†</li></ul></li><li>ç»å¸¸å˜çš„éƒ¨åˆ†è¦åœ¨å¤–éƒ¨ç»´æŠ¤è€Œä¸æ˜¯æ”¾åœ¨ä»£ç é‡Œ <ul><li>æ¯”å¦‚ Prompt æ¨¡æ¿</li></ul></li><li>å„ç§ç¯å¢ƒä¸‹éƒ½é€‚ç”¨ <ul><li>æ¯”å¦‚çº¿ç¨‹å®‰å…¨</li></ul></li><li>æ–¹ä¾¿è°ƒè¯•å’Œæµ‹è¯• <ul><li>è‡³å°‘è¦èƒ½æ„Ÿè§‰åˆ°ç”¨äº†æ¯”ä¸ç”¨æ–¹ä¾¿å§</li><li>åˆæ³•çš„è¾“å…¥ä¸ä¼šå¼•å‘æ¡†æ¶å†…éƒ¨çš„æŠ¥é”™</li></ul></li></ul><blockquote><p>âœ… <strong>Tip:</strong> åˆ’é‡ç‚¹ï¼šé€‰å¯¹äº†æ¡†æ¶ï¼Œäº‹åŠåŠŸå€ï¼›åä¹‹ï¼Œäº‹å€åŠŸåŠã€‚</p></blockquote><blockquote><p>â„¹ï¸ <strong>Info:</strong> ä»€ä¹ˆæ˜¯ SDK? https://aws.amazon.com/cn/what-is/sdk/</p></blockquote><p>SDK å’Œ API çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ? https://aws.amazon.com/cn/compare/the-difference-between-sdk-and-api/</p><h4 id="ğŸŒ°-ä¸¾ä¸ªä¾‹å­-ä½¿ç”¨-sdk-4-è¡Œä»£ç å®ç°ä¸€ä¸ªç®€æ˜“çš„-rag-ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#ğŸŒ°-ä¸¾ä¸ªä¾‹å­-ä½¿ç”¨-sdk-4-è¡Œä»£ç å®ç°ä¸€ä¸ªç®€æ˜“çš„-rag-ç³»ç»Ÿ"><span>ğŸŒ° ä¸¾ä¸ªä¾‹å­ï¼šä½¿ç”¨ SDKï¼Œ4 è¡Œä»£ç å®ç°ä¸€ä¸ªç®€æ˜“çš„ RAG ç³»ç»Ÿ</span></a></h4><blockquote><p>âš ï¸ <strong>Note:</strong> è¿è¡Œæœ¬è¯¾ä»£ç å‰ï¼Œè¯·å…ˆé‡å¯ä¸€ä¸‹ kernelï¼Œä»¥é‡ç½®æ‰€æœ‰é…ç½®ã€‚</p></blockquote><p><img src="/wiki/assets/img/tips.0f182de9.png" alt="image"></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">!pip install <span class="token operator">-</span><span class="token operator">-</span>upgrade llama<span class="token operator">-</span>index</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> VectorStoreIndex<span class="token punctuation">,</span> SimpleDirectoryReader</span>
<span class="line"></span>
<span class="line">documents <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span><span class="token string">&quot;./data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">index <span class="token operator">=</span> VectorStoreIndex<span class="token punctuation">.</span>from_documents<span class="token punctuation">(</span>documents<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">query_engine <span class="token operator">=</span> index<span class="token punctuation">.</span>as_query_engine<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">response <span class="token operator">=</span> query_engine<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;llama2æœ‰å¤šå°‘å‚æ•°&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2 ranges in scale from 7 billion to 70 billion parameters.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2ã€llamaindex-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_2ã€llamaindex-ä»‹ç»"><span>2ã€LlamaIndex ä»‹ç»</span></a></h2><p><em>ã€Œ LlamaIndex is a framework for building context-augmented LLM applications. Context augmentation refers to any use case that applies LLMs on top of your private or domain-specific data. ã€</em></p><p>LlamaIndex æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€Œä¸Šä¸‹æ–‡å¢å¼ºã€çš„å¤§è¯­è¨€æ¨¡å‹åº”ç”¨çš„æ¡†æ¶ï¼ˆä¹Ÿå°±æ˜¯ SDKï¼‰ã€‚<strong>ä¸Šä¸‹æ–‡å¢å¼º</strong>ï¼Œæ³›æŒ‡ä»»ä½•åœ¨ç§æœ‰æˆ–ç‰¹å®šé¢†åŸŸæ•°æ®åŸºç¡€ä¸Šåº”ç”¨å¤§è¯­è¨€æ¨¡å‹çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼š</p><p><img src="/wiki/assets/img/basic_rag.2707cb36.png" alt="image"></p><ul><li><p>Question-Answering Chatbots (ä¹Ÿå°±æ˜¯ RAG)</p></li><li><p>Document Understanding and Extraction ï¼ˆæ–‡æ¡£ç†è§£ä¸ä¿¡æ¯æŠ½å–ï¼‰</p></li><li><p>Autonomous Agents that can perform research and take actions ï¼ˆæ™ºèƒ½ä½“åº”ç”¨ï¼‰</p></li></ul><p>LlamaIndex æœ‰ Python å’Œ Typescript ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒPython ç‰ˆçš„æ–‡æ¡£ç›¸å¯¹æ›´å®Œå–„ã€‚</p><ul><li><p>Python æ–‡æ¡£åœ°å€ï¼šhttps://docs.llamaindex.ai/en/stable/</p></li><li><p>Python API æ¥å£æ–‡æ¡£ï¼šhttps://docs.llamaindex.ai/en/stable/api_reference/</p></li><li><p>TS æ–‡æ¡£åœ°å€ï¼šhttps://ts.llamaindex.ai/</p></li><li><p>TS API æ¥å£æ–‡æ¡£ï¼šhttps://ts.llamaindex.ai/api/</p></li></ul><p>LlamaIndex æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼ŒGithub é“¾æ¥ï¼šhttps://github.com/run-llama</p><h3 id="llamaindex-çš„æ ¸å¿ƒæ¨¡å—" tabindex="-1"><a class="header-anchor" href="#llamaindex-çš„æ ¸å¿ƒæ¨¡å—"><span>LlamaIndex çš„æ ¸å¿ƒæ¨¡å—</span></a></h3><p><img src="/wiki/assets/img/llamaindex.010a9ced.png" alt="LlamaIndex æ ¸å¿ƒæ¨¡å—"></p><h3 id="å®‰è£…-llamaindex" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-llamaindex"><span>å®‰è£… LlamaIndex</span></a></h3><ol><li>Python</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">pip install llama-index</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>Typescript</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line"># é€šè¿‡ npm å®‰è£…</span>
<span class="line">npm install llamaindex</span>
<span class="line"></span>
<span class="line"># é€šè¿‡ yarn å®‰è£…</span>
<span class="line">yarn add llamaindex</span>
<span class="line"></span>
<span class="line"># é€šè¿‡ pnpm å®‰è£…</span>
<span class="line">pnpm add llamaindex</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ¬è¯¾ç¨‹ä»¥ Python ç‰ˆä¸ºä¾‹è¿›è¡Œè®²è§£ã€‚</p><h2 id="_3ã€æ•°æ®åŠ è½½-loading" tabindex="-1"><a class="header-anchor" href="#_3ã€æ•°æ®åŠ è½½-loading"><span>3ã€æ•°æ®åŠ è½½ï¼ˆLoadingï¼‰</span></a></h2><h3 id="_3-1ã€åŠ è½½æœ¬åœ°æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_3-1ã€åŠ è½½æœ¬åœ°æ•°æ®"><span>3.1ã€åŠ è½½æœ¬åœ°æ•°æ®</span></a></h3><p><code>SimpleDirectoryReader</code> æ˜¯ä¸€ä¸ªç®€å•çš„æœ¬åœ°æ–‡ä»¶åŠ è½½å™¨ã€‚å®ƒä¼šéå†æŒ‡å®šç›®å½•ï¼Œå¹¶æ ¹æ®æ–‡ä»¶æ‰©å±•åè‡ªåŠ¨åŠ è½½æ–‡ä»¶ï¼ˆ<strong>æ–‡æœ¬å†…å®¹</strong>ï¼‰ã€‚</p><p>æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼š</p><ul><li><code>.csv</code> - comma-separated values</li><li><code>.docx</code> - Microsoft Word</li><li><code>.epub</code> - EPUB ebook format</li><li><code>.hwp</code> - Hangul Word Processor</li><li><code>.ipynb</code> - Jupyter Notebook</li><li><code>.jpeg</code>, <code>.jpg</code> - JPEG image</li><li><code>.mbox</code> - MBOX email archive</li><li><code>.md</code> - Markdown</li><li><code>.mp3</code>, <code>.mp4</code> - audio and video</li><li><code>.pdf</code> - Portable Document Format</li><li><code>.png</code> - Portable Network Graphics</li><li><code>.ppt</code>, <code>.pptm</code>, <code>.pptx</code> - Microsoft PowerPoint</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">from</span> pydantic<span class="token punctuation">.</span>v1 <span class="token keyword">import</span> BaseModel</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">show_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;ç”¨äºå±•ç¤ºjsonæ•°æ®&quot;&quot;&quot;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        obj <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token builtin">issubclass</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">show_list_obj</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;ç”¨äºå±•ç¤ºä¸€ç»„å¯¹è±¡&quot;&quot;&quot;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span></span>
<span class="line">            show_json<span class="token punctuation">(</span>item<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">&quot;Input is not a list&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> SimpleDirectoryReader</span>
<span class="line"></span>
<span class="line">reader <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span></span>
<span class="line">        input_dir<span class="token operator">=</span><span class="token string">&quot;./data&quot;</span><span class="token punctuation">,</span> <span class="token comment"># ç›®æ ‡ç›®å½•</span></span>
<span class="line">        recursive<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># æ˜¯å¦é€’å½’éå†å­ç›®å½•</span></span>
<span class="line">        required_exts<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">]</span> <span class="token comment"># (å¯é€‰)åªè¯»å–æŒ‡å®šåç¼€çš„æ–‡ä»¶</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">documents <span class="token operator">=</span> reader<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>documents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line">show_json<span class="token punctuation">(</span>documents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2: OpenFoundation andFine-Tuned ChatModels</span>
<span class="line">Hugo Touvronâˆ—Louis Martinâ€ Kevin Stoneâ€ </span>
<span class="line">Peter Albert Amjad Almahairi Yasmine Babaei Nikolay Bashlykov SoumyaBatra</span>
<span class="line">Prajjwal Bhargava Shruti Bhosale Dan Bikel LukasBlecher Cristian CantonFerrer MoyaChen</span>
<span class="line">Guillem Cucurull David Esiobu Jude Fernandes Jeremy Fu Wenyin Fu BrianFuller</span>
<span class="line">Cynthia Gao VedanujGoswami NamanGoyal AnthonyHartshorn Saghar Hosseini RuiHou</span>
<span class="line">Hakan Inan Marcin Kardas Viktor Kerkez Madian Khabsa IsabelKloumann ArtemKorenev</span>
<span class="line">Punit Singh Koura Marie-AnneLachaux ThibautLavril Jenya Lee Diana Liskovich</span>
<span class="line">Yinghai Lu YuningMao Xavier Martinet Todor Mihaylov PushkarMishra</span>
<span class="line">Igor Molybog Yixin Nie AndrewPoulton Jeremy Reizenstein Rashi Rungta Kalyan Saladi</span>
<span class="line">Alan Schelten Ruan Silva EricMichael Smith Ranjan Subramanian XiaoqingEllenTan BinhTang</span>
<span class="line">Ross Taylor AdinaWilliams JianXiang Kuan PuxinXu ZhengYan Iliyan Zarov YuchenZhang</span>
<span class="line">Angela Fan MelanieKambadur SharanNarang Aurelien Rodriguez RobertStojnic</span>
<span class="line">Sergey Edunov ThomasScialomâˆ—</span>
<span class="line">GenAI, Meta</span>
<span class="line">Abstract</span>
<span class="line">In this work, we develop and release Llama 2, a collection of pretrained and fine-tuned</span>
<span class="line">large language models (LLMs) ranging in scale from 7 billion to 70 billion parameters.</span>
<span class="line">Our fine-tuned LLMs, called Llama 2-Chat , are optimized for dialogue use cases. Our</span>
<span class="line">models outperform open-source chat models on most benchmarks we tested, and based on</span>
<span class="line">ourhumanevaluationsforhelpfulnessandsafety,maybeasuitablesubstituteforclosed-</span>
<span class="line">source models. We provide a detailed description of our approach to fine-tuning and safety</span>
<span class="line">improvements of Llama 2-Chat in order to enable the community to build on our work and</span>
<span class="line">contribute to the responsibledevelopmentof LLMs.</span>
<span class="line">âˆ—Equal contribution, corresponding authors: {tscialom, htouvron}@meta.com</span>
<span class="line">â€ Second author</span>
<span class="line">Contributions for all the authors can be found in Section A.1.arXiv:2307.09288v2  [cs.CL]  19 Jul 2023</span>
<span class="line">{</span>
<span class="line">    &quot;id_&quot;: &quot;045248bf-9292-4c32-a82c-abfb63ca0aaa&quot;,</span>
<span class="line">    &quot;embedding&quot;: null,</span>
<span class="line">    &quot;metadata&quot;: {</span>
<span class="line">        &quot;page_label&quot;: &quot;1&quot;,</span>
<span class="line">        &quot;file_name&quot;: &quot;llama2-extracted.pdf&quot;,</span>
<span class="line">        &quot;file_path&quot;: &quot;/home/jovyan/lecture-notes/07-llamaindex/data/llama2-extracted.pdf&quot;,</span>
<span class="line">        &quot;file_type&quot;: &quot;application/pdf&quot;,</span>
<span class="line">        &quot;file_size&quot;: 401338,</span>
<span class="line">        &quot;creation_date&quot;: &quot;2024-06-14&quot;,</span>
<span class="line">        &quot;last_modified_date&quot;: &quot;2024-06-14&quot;</span>
<span class="line">    },</span>
<span class="line">    &quot;excluded_embed_metadata_keys&quot;: [</span>
<span class="line">        &quot;file_name&quot;,</span>
<span class="line">        &quot;file_type&quot;,</span>
<span class="line">        &quot;file_size&quot;,</span>
<span class="line">        &quot;creation_date&quot;,</span>
<span class="line">        &quot;last_modified_date&quot;,</span>
<span class="line">        &quot;last_accessed_date&quot;</span>
<span class="line">    ],</span>
<span class="line">    &quot;excluded_llm_metadata_keys&quot;: [</span>
<span class="line">        &quot;file_name&quot;,</span>
<span class="line">        &quot;file_type&quot;,</span>
<span class="line">        &quot;file_size&quot;,</span>
<span class="line">        &quot;creation_date&quot;,</span>
<span class="line">        &quot;last_modified_date&quot;,</span>
<span class="line">        &quot;last_accessed_date&quot;</span>
<span class="line">    ],</span>
<span class="line">    &quot;relationships&quot;: {},</span>
<span class="line">    &quot;text&quot;: &quot;Llama 2: OpenFoundation andFine-Tuned ChatModels\nHugo Touvronâˆ—Louis Martinâ€ Kevin Stoneâ€ \nPeter Albert Amjad Almahairi Yasmine Babaei Nikolay Bashlykov SoumyaBatra\nPrajjwal Bhargava Shruti Bhosale Dan Bikel LukasBlecher Cristian CantonFerrer MoyaChen\nGuillem Cucurull David Esiobu Jude Fernandes Jeremy Fu Wenyin Fu BrianFuller\nCynthia Gao VedanujGoswami NamanGoyal AnthonyHartshorn Saghar Hosseini RuiHou\nHakan Inan Marcin Kardas Viktor Kerkez Madian Khabsa IsabelKloumann ArtemKorenev\nPunit Singh Koura Marie-AnneLachaux ThibautLavril Jenya Lee Diana Liskovich\nYinghai Lu YuningMao Xavier Martinet Todor Mihaylov PushkarMishra\nIgor Molybog Yixin Nie AndrewPoulton Jeremy Reizenstein Rashi Rungta Kalyan Saladi\nAlan Schelten Ruan Silva EricMichael Smith Ranjan Subramanian XiaoqingEllenTan BinhTang\nRoss Taylor AdinaWilliams JianXiang Kuan PuxinXu ZhengYan Iliyan Zarov YuchenZhang\nAngela Fan MelanieKambadur SharanNarang Aurelien Rodriguez RobertStojnic\nSergey Edunov ThomasScialomâˆ—\nGenAI, Meta\nAbstract\nIn this work, we develop and release Llama 2, a collection of pretrained and fine-tuned\nlarge language models (LLMs) ranging in scale from 7 billion to 70 billion parameters.\nOur fine-tuned LLMs, called Llama 2-Chat , are optimized for dialogue use cases. Our\nmodels outperform open-source chat models on most benchmarks we tested, and based on\nourhumanevaluationsforhelpfulnessandsafety,maybeasuitablesubstituteforclosed-\nsource models. We provide a detailed description of our approach to fine-tuning and safety\nimprovements of Llama 2-Chat in order to enable the community to build on our work and\ncontribute to the responsibledevelopmentof LLMs.\nâˆ—Equal contribution, corresponding authors: {tscialom, htouvron}@meta.com\nâ€ Second author\nContributions for all the authors can be found in Section A.1.arXiv:2307.09288v2  [cs.CL]  19 Jul 2023&quot;,</span>
<span class="line">    &quot;mimetype&quot;: &quot;text/plain&quot;,</span>
<span class="line">    &quot;start_char_idx&quot;: null,</span>
<span class="line">    &quot;end_char_idx&quot;: null,</span>
<span class="line">    &quot;text_template&quot;: &quot;{metadata_str}\n\n{content}&quot;,</span>
<span class="line">    &quot;metadata_template&quot;: &quot;{key}: {value}&quot;,</span>
<span class="line">    &quot;metadata_seperator&quot;: &quot;\n&quot;,</span>
<span class="line">    &quot;class_name&quot;: &quot;Document&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âš ï¸ <strong>Note:</strong> æ³¨æ„ï¼šå¯¹å›¾åƒã€è§†é¢‘ã€è¯­éŸ³ç±»æ–‡ä»¶ï¼Œé»˜è®¤ä¸ä¼šè‡ªåŠ¨æå–å…¶ä¸­æ–‡å­—ã€‚å¦‚éœ€æå–ï¼Œå‚è€ƒä¸‹é¢ä»‹ç»çš„ Data Connectorsã€‚</p></blockquote><p>é»˜è®¤çš„ <code>PDFReader</code> æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¢æ–‡ä»¶åŠ è½½å™¨</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># !pip install pymupdf</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> SimpleDirectoryReader</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token keyword">import</span> PyMuPDFReader</span>
<span class="line"></span>
<span class="line">reader <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span></span>
<span class="line">        input_dir<span class="token operator">=</span><span class="token string">&quot;./data&quot;</span><span class="token punctuation">,</span> <span class="token comment"># ç›®æ ‡ç›®å½•</span></span>
<span class="line">        recursive<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment"># æ˜¯å¦é€’å½’éå†å­ç›®å½•</span></span>
<span class="line">        required_exts<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># (å¯é€‰)åªè¯»å–æŒ‡å®šåç¼€çš„æ–‡ä»¶</span></span>
<span class="line">        file_extractor<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">:</span> PyMuPDFReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment"># æŒ‡å®šç‰¹å®šçš„æ–‡ä»¶åŠ è½½å™¨</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">documents <span class="token operator">=</span> reader<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>documents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2: Open Foundation and Fine-Tuned Chat Models</span>
<span class="line">Hugo Touvronâˆ—</span>
<span class="line">Louis Martinâ€ </span>
<span class="line">Kevin Stoneâ€ </span>
<span class="line">Peter Albert Amjad Almahairi Yasmine Babaei Nikolay Bashlykov Soumya Batra</span>
<span class="line">Prajjwal Bhargava Shruti Bhosale Dan Bikel Lukas Blecher Cristian Canton Ferrer Moya Chen</span>
<span class="line">Guillem Cucurull David Esiobu Jude Fernandes Jeremy Fu Wenyin Fu Brian Fuller</span>
<span class="line">Cynthia Gao Vedanuj Goswami Naman Goyal Anthony Hartshorn Saghar Hosseini Rui Hou</span>
<span class="line">Hakan Inan Marcin Kardas Viktor Kerkez Madian Khabsa Isabel Kloumann Artem Korenev</span>
<span class="line">Punit Singh Koura Marie-Anne Lachaux Thibaut Lavril Jenya Lee Diana Liskovich</span>
<span class="line">Yinghai Lu Yuning Mao Xavier Martinet Todor Mihaylov Pushkar Mishra</span>
<span class="line">Igor Molybog Yixin Nie Andrew Poulton Jeremy Reizenstein Rashi Rungta Kalyan Saladi</span>
<span class="line">Alan Schelten Ruan Silva Eric Michael Smith Ranjan Subramanian Xiaoqing Ellen Tan Binh Tang</span>
<span class="line">Ross Taylor Adina Williams Jian Xiang Kuan Puxin Xu Zheng Yan Iliyan Zarov Yuchen Zhang</span>
<span class="line">Angela Fan Melanie Kambadur Sharan Narang Aurelien Rodriguez Robert Stojnic</span>
<span class="line">Sergey Edunov</span>
<span class="line">Thomas Scialomâˆ—</span>
<span class="line">GenAI, Meta</span>
<span class="line">Abstract</span>
<span class="line">In this work, we develop and release Llama 2, a collection of pretrained and fine-tuned</span>
<span class="line">large language models (LLMs) ranging in scale from 7 billion to 70 billion parameters.</span>
<span class="line">Our fine-tuned LLMs, called Llama 2-Chat, are optimized for dialogue use cases. Our</span>
<span class="line">models outperform open-source chat models on most benchmarks we tested, and based on</span>
<span class="line">our human evaluations for helpfulness and safety, may be a suitable substitute for closed-</span>
<span class="line">source models. We provide a detailed description of our approach to fine-tuning and safety</span>
<span class="line">improvements of Llama 2-Chat in order to enable the community to build on our work and</span>
<span class="line">contribute to the responsible development of LLMs.</span>
<span class="line">âˆ—Equal contribution, corresponding authors: {tscialom, htouvron}@meta.com</span>
<span class="line">â€ Second author</span>
<span class="line">Contributions for all the authors can be found in Section A.1.</span>
<span class="line">arXiv:2307.09288v2  [cs.CL]  19 Jul 2023</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å¤šçš„ PDF åŠ è½½å™¨è¿˜æœ‰ <a href="https://llamahub.ai/l/readers/llama-index-readers-smart-pdf-loader?from=readers" target="_blank" rel="noopener noreferrer"><code>SmartPDFLoader</code></a> å’Œ <a href="https://llamahub.ai/l/readers/llama-index-readers-llama-parse?from=readers" target="_blank" rel="noopener noreferrer"><code>LlamaParse</code></a>, äºŒè€…éƒ½æä¾›äº†æ›´ä¸°å¯Œçš„è§£æèƒ½åŠ›ï¼ŒåŒ…æ‹¬è§£æç« èŠ‚ä¸æ®µè½ç»“æ„ç­‰ã€‚ä½†ä¸æ˜¯ 100%å‡†ç¡®ï¼Œå¶æœ‰æ–‡å­—ä¸¢å¤±æˆ–é”™ä½æƒ…å†µï¼Œå»ºè®®æ ¹æ®è‡ªèº«éœ€æ±‚è¯¦ç»†æµ‹è¯•è¯„ä¼°ã€‚</p><h3 id="_3-2ã€data-connectors" tabindex="-1"><a class="header-anchor" href="#_3-2ã€data-connectors"><span>3.2ã€Data Connectors</span></a></h3><p>ç”¨äºå¤„ç†æ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œå¹¶å°†å…¶è¯»å–ä¸º <code>Document</code> çš„å½¢å¼ï¼ˆtext + metadataï¼‰ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># !pip install llama-index-readers-feishu-docs</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span>feishu_docs <span class="token keyword">import</span> FeishuDocsReader</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è§è¯´æ˜æ–‡æ¡£</span></span>
<span class="line">app_id <span class="token operator">=</span> <span class="token string">&quot;cli_a6f1c0fa1fd9d00b&quot;</span></span>
<span class="line">app_secret <span class="token operator">=</span> <span class="token string">&quot;dMXCTy8DGaty2xn8I858ZbFDFvcqgiep&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># https://agiclass.feishu.cn/docx/FULadzkWmovlfkxSgLPcE4oWnPf</span></span>
<span class="line"><span class="token comment"># é“¾æ¥æœ€åçš„ &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot; ä¸ºæ–‡æ¡£ ID </span></span>
<span class="line">doc_ids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰é£ä¹¦æ–‡æ¡£åŠ è½½å™¨</span></span>
<span class="line">loader <span class="token operator">=</span> FeishuDocsReader<span class="token punctuation">(</span>app_id<span class="token punctuation">,</span> app_secret<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½æ–‡æ¡£</span></span>
<span class="line">documents <span class="token operator">=</span> loader<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span>document_ids<span class="token operator">=</span>doc_ids<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ˜¾ç¤ºå‰1000å­—ç¬¦</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>documents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">AI å¤§æ¨¡å‹å…¨æ ˆå·¥ç¨‹å¸ˆåŸ¹å…»è®¡åˆ’ - AGIClass.ai</span>
<span class="line"></span>
<span class="line">ç”± AGI è¯¾å ‚æ¨å‡ºçš„ç¤¾ç¾¤å‹ä¼šå‘˜åˆ¶è¯¾ç¨‹ï¼Œä¼ æˆå¤§æ¨¡å‹çš„åŸç†ã€åº”ç”¨å¼€å‘æŠ€æœ¯å’Œè¡Œä¸šè®¤çŸ¥ï¼ŒåŠ©ä½ æˆä¸º ChatGPT æµªæ½®ä¸­çš„è¶…çº§ä¸ªä½“</span>
<span class="line">ä»€ä¹ˆæ˜¯ AI å¤§æ¨¡å‹å…¨æ ˆå·¥ç¨‹å¸ˆï¼Ÿ</span>
<span class="line">ã€ŒAI å¤§æ¨¡å‹å…¨æ ˆå·¥ç¨‹å¸ˆã€ç®€ç§°ã€ŒAI å…¨æ ˆã€ï¼Œæ˜¯ä¸€ä¸ªäººå°±èƒ½å€ŸåŠ© AIï¼Œè®¾è®¡ã€å¼€å‘å’Œè¿è¥åŸºäº AI çš„å¤§æ¨¡å‹åº”ç”¨çš„è¶…çº§ä¸ªä½“ã€‚</span>
<span class="line">AI å…¨æ ˆéœ€è¦æ‡‚ä¸šåŠ¡ã€æ‡‚ AIã€æ‡‚ç¼–ç¨‹ï¼Œä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªå›¢é˜Ÿï¼Œå•æªåŒ¹é©¬åˆ›é€ è´¢å¯Œã€‚</span>
<span class="line">åœ¨æŠ€æœ¯å‹å…¬å¸ï¼ŒAI å…¨æ ˆæœ€æ‡‚ AIï¼Œç¬é—´ç«™ä¸ŠæŠ€æœ¯é¡¶å³°ã€‚</span>
<span class="line">åœ¨éæŠ€æœ¯å‹å…¬å¸ï¼ŒAI å…¨æ ˆè¿æ¥å…¶ä»–å‘˜å·¥å’Œ AIï¼Œæå‡æ•´ä¸ªå…¬å¸çš„æ•ˆç‡ã€‚</span>
<span class="line">åœ¨å…¬å¸å¤–ï¼ŒAI å…¨æ ˆæ¥é¡¹ç›®ï¼Œç‹¬ç«‹å¼€å‘å˜ç°å°å·¥å…·ï¼Œèµšå–ä¸°åšå‰¯ä¸šæ”¶å…¥ã€‚</span>
<span class="line">é€‚åˆäººç¾¤</span>
<span class="line">å­¦ä¹ æœ¬è¯¾ç¨‹ï¼Œå¯ä»¥åœ¨ä¸‹è¿°ç›®æ ‡ä¸­ä¸‰é€‰ä¸€ï¼š</span>
<span class="line">æˆä¸º AI å…¨æ ˆï¼šæ‡‚ä¸šåŠ¡ã€æ‡‚ AI ä¹Ÿæ‡‚ç¼–ç¨‹ã€‚å¤§é‡ä½¿ç”¨ AIï¼Œè‡ªå·±å®Œæˆ AI åº”ç”¨ä»ç­–åˆ’ã€å¼€å‘åˆ°è½åœ°çš„å…¨è¿‡ç¨‹ã€‚åŒ…æ‹¬å•†ä¸šåˆ†æã€éœ€æ±‚åˆ†æã€äº§å“è®¾è®¡ã€å¼€å‘ã€æµ‹è¯•ã€å¸‚åœºæ¨å¹¿å’Œè¿è¥ç­‰</span>
<span class="line">æˆä¸ºä¸šåŠ¡å‘ AI å…¨æ ˆï¼šæ‡‚ä¸šåŠ¡ä¹Ÿæ‡‚ AIï¼Œä¸ç¨‹åºå‘˜åˆä½œï¼Œä¸€èµ·å®Œæˆ AI åº”ç”¨ä»ç­–åˆ’ã€å¼€å‘åˆ°è½åœ°çš„å…¨è¿‡ç¨‹</span>
<span class="line">æˆä¸ºç¼–ç¨‹å‘ AI å…¨æ ˆï¼šæ‡‚ç¼–ç¨‹ä¹Ÿæ‡‚ AIï¼Œä¸ä¸šåŠ¡äººå‘˜åˆä½œï¼Œä¸€èµ·å®Œæˆ AI åº”ç”¨ä»ç­–åˆ’ã€å¼€å‘åˆ°è½åœ°çš„å…¨è¿‡ç¨‹</span>
<span class="line">æ‡‚è‡³å°‘ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶æœ‰è¿‡çœŸå®é¡¹ç›®å¼€å‘ç»éªŒçš„è½¯ä»¶å¼€å‘â¼¯ç¨‹å¸ˆã€â¾¼çº§â¼¯ç¨‹å¸ˆã€æŠ€æœ¯æ€»ç›‘ã€ç ”å‘ç»ç†ã€æ¶æ„å¸ˆã€æµ‹è¯•â¼¯ç¨‹å¸ˆã€æ•°æ®å·¥ç¨‹å¸ˆã€è¿ç»´å·¥ç¨‹å¸ˆç­‰ï¼Œå»ºè®®ä»¥ã€ŒAI å…¨æ ˆã€ä¸ºç›®æ ‡ã€‚å³ä¾¿å¯¹å•†ä¸šã€äº§å“ã€å¸‚åœºç­‰çš„å­¦ä¹ è¾¾ä¸åˆ°æœ€ä½³ï¼Œä½†å·²æŒæ¡çš„ç»éªŒå’Œè®¤çŸ¥ä¹Ÿæœ‰åŠ©äºæˆä¸ºæœ‰ç«äº‰åŠ›çš„ã€Œç¼–ç¨‹å‘AI å…¨æ ˆã€ã€‚</span>
<span class="line">ä¸æ‡‚ç¼–ç¨‹çš„äº§å“ç»ç†ã€éœ€æ±‚åˆ†æå¸ˆã€åˆ›ä¸šè€…ã€è€æ¿ã€è§£å†³æ–¹æ¡ˆå·¥ç¨‹å¸ˆã€é¡¹ç›®ç»ç†ã€è¿è¥ã€å¸‚åœºã€é”€å”®ã€è®¾è®¡å¸ˆç­‰ï¼Œå»ºè®®ä¼˜å…ˆé€‰æ‹©ã€Œä¸šåŠ¡å‘ AI å…¨æ ˆã€ä¸ºç›®æ ‡ã€‚åœ¨è¯¾ç¨‹æä¾›çš„æŠ€æœ¯ç¯å¢ƒé‡Œç†é™¶ï¼Œæé«˜æŠ€æœ¯é¢†åŸŸçš„åˆ¤æ–­åŠ›ï¼Œæœªæ¥å¯ä»¥å’ŒæŠ€æœ¯äººå‘˜æ›´æµç•…åœ°æ²Ÿé€šåä½œã€‚å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå¦‚æœèƒ½å–„ç”¨ AI å­¦ä¹ ç¼–ç¨‹ã€è¾…åŠ©ç¼–ç¨‹ï¼Œå°±å¯ä»¥å‘ã€ŒAI å…¨æ ˆã€è¿ˆè¿›ã€‚</span>
<span class="line">å¸ˆèµ„åŠ›é‡</span>
<span class="line">é¦–å¸­è®²å¸ˆ - ç‹å“ç„¶</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">image.png</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦æœ¬ç¡•ï¼Œè‹±å›½ UCL åšå£«ï¼Œå›½é™…çŸ¥åå­¦è€…ã€ä¼ä¸šå®¶ï¼Œå¸ˆä»ç»Ÿè®¡æœºå™¨å­¦ä¹ ç†è®ºå¥ åŸºäººä¹‹ä¸€ John Shawe-Taylor æ•™æˆï¼Œæ˜¯æœ€æ—©ä»äº‹äººæœºå¯¹è¯ç ”ç©¶çš„åè£”å­¦è€…ä¹‹ä¸€ï¼Œè‡³ä»Šå·²è¶… 20 å¹´ã€‚</span>
<span class="line">ä»–å°±æ˜¯ AI å…¨æ ˆï¼Œä»åœ¨ç ”å‘ä¸€çº¿ï¼Œå•äººé”€å”®ã€å”®å‰ã€å¼€å‘ã€å®æ–½å…¨æµç¨‹äº¤ä»˜å¤šä¸ªæ•°ç™¾ä¸‡é‡‘é¢ AI é¡¹ç›®ï¼Œå…¨æ ˆå®æˆ˜ç»éªŒ</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>â„¹ï¸ <strong>Info:</strong> æ›´å¤š Data Connectors</p></blockquote><pre><code>    å†…ç½®çš„æ–‡ä»¶åŠ è½½å™¨
    è¿æ¥ä¸‰æ–¹æœåŠ¡çš„æ•°æ®åŠ è½½å™¨ï¼Œä¾‹å¦‚æ•°æ®åº“
    æ›´å¤šåŠ è½½å™¨å¯ä»¥åœ¨ LlamaHub ä¸Šæ‰¾åˆ°
</code></pre><h2 id="_4ã€æ–‡æœ¬åˆ‡åˆ†ä¸è§£æ-chunking" tabindex="-1"><a class="header-anchor" href="#_4ã€æ–‡æœ¬åˆ‡åˆ†ä¸è§£æ-chunking"><span>4ã€æ–‡æœ¬åˆ‡åˆ†ä¸è§£æï¼ˆChunkingï¼‰</span></a></h2><p>ä¸ºæ–¹ä¾¿æ£€ç´¢ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠ <code>Document</code> åˆ‡åˆ†ä¸º <code>Node</code>ã€‚</p><p>åœ¨ LlamaIndex ä¸­ï¼Œ<code>Node</code> è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ–‡æœ¬çš„ã€Œchunkã€ã€‚</p><h3 id="_4-1ã€ä½¿ç”¨-textsplitters-å¯¹æ–‡æœ¬åšåˆ‡åˆ†" tabindex="-1"><a class="header-anchor" href="#_4-1ã€ä½¿ç”¨-textsplitters-å¯¹æ–‡æœ¬åšåˆ‡åˆ†"><span>4.1ã€ä½¿ç”¨ TextSplitters å¯¹æ–‡æœ¬åšåˆ‡åˆ†</span></a></h3><p>ä¾‹å¦‚ï¼š<code>TokenTextSplitter</code> æŒ‰æŒ‡å®š token æ•°åˆ‡åˆ†æ–‡æœ¬</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> Document</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>node_parser <span class="token keyword">import</span> TokenTextSplitter</span>
<span class="line"></span>
<span class="line">node_parser <span class="token operator">=</span> TokenTextSplitter<span class="token punctuation">(</span></span>
<span class="line">    chunk_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># æ¯ä¸ª chunk çš„æœ€å¤§é•¿åº¦</span></span>
<span class="line">    chunk_overlap<span class="token operator">=</span><span class="token number">50</span>  <span class="token comment"># chunk ä¹‹é—´é‡å é•¿åº¦ </span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">nodes <span class="token operator">=</span> node_parser<span class="token punctuation">.</span>get_nodes_from_documents<span class="token punctuation">(</span></span>
<span class="line">    documents<span class="token punctuation">,</span> show_progress<span class="token operator">=</span><span class="token boolean">False</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">show_json<span class="token punctuation">(</span>nodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">show_json<span class="token punctuation">(</span>nodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">{</span>
<span class="line">    &quot;id_&quot;: &quot;0a1eee9a-635a-4391-8b74-75bf3c648f0e&quot;,</span>
<span class="line">    &quot;embedding&quot;: null,</span>
<span class="line">    &quot;metadata&quot;: {</span>
<span class="line">        &quot;document_id&quot;: &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span>
<span class="line">    },</span>
<span class="line">    &quot;excluded_embed_metadata_keys&quot;: [],</span>
<span class="line">    &quot;excluded_llm_metadata_keys&quot;: [],</span>
<span class="line">    &quot;relationships&quot;: {</span>
<span class="line">        &quot;1&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;9cd5baeb-1c59-448a-9c95-df7fb634b6bb&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;4&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;document_id&quot;: &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;aa5f32dabade1da0e01c23cb16e160b624565d09a4a2a07fb7f7fd4d45aac88a&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;3&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;1a1aa20f-a88a-49a6-a0c6-fd13700022e4&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {},</span>
<span class="line">            &quot;hash&quot;: &quot;654c6cbdd5a23946a84e84e6f3a474de2a442191b2be2d817ba7f04286b1a980&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        }</span>
<span class="line">    },</span>
<span class="line">    &quot;text&quot;: &quot;AI å¤§æ¨¡å‹å…¨æ ˆå·¥ç¨‹å¸ˆåŸ¹å…»è®¡åˆ’ - AGIClass.ai\n\nç”± AGI è¯¾å ‚æ¨å‡ºçš„ç¤¾ç¾¤å‹ä¼šå‘˜åˆ¶è¯¾ç¨‹ï¼Œä¼ æˆå¤§æ¨¡å‹çš„åŸç†ã€åº”ç”¨å¼€å‘æŠ€æœ¯å’Œè¡Œä¸šè®¤çŸ¥ï¼ŒåŠ©ä½ æˆä¸º&quot;,</span>
<span class="line">    &quot;mimetype&quot;: &quot;text/plain&quot;,</span>
<span class="line">    &quot;start_char_idx&quot;: 0,</span>
<span class="line">    &quot;end_char_idx&quot;: 76,</span>
<span class="line">    &quot;text_template&quot;: &quot;{metadata_str}\n\n{content}&quot;,</span>
<span class="line">    &quot;metadata_template&quot;: &quot;{key}: {value}&quot;,</span>
<span class="line">    &quot;metadata_seperator&quot;: &quot;\n&quot;,</span>
<span class="line">    &quot;class_name&quot;: &quot;TextNode&quot;</span>
<span class="line">}</span>
<span class="line">{</span>
<span class="line">    &quot;id_&quot;: &quot;1a1aa20f-a88a-49a6-a0c6-fd13700022e4&quot;,</span>
<span class="line">    &quot;embedding&quot;: null,</span>
<span class="line">    &quot;metadata&quot;: {</span>
<span class="line">        &quot;document_id&quot;: &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span>
<span class="line">    },</span>
<span class="line">    &quot;excluded_embed_metadata_keys&quot;: [],</span>
<span class="line">    &quot;excluded_llm_metadata_keys&quot;: [],</span>
<span class="line">    &quot;relationships&quot;: {</span>
<span class="line">        &quot;1&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;9cd5baeb-1c59-448a-9c95-df7fb634b6bb&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;4&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;document_id&quot;: &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;aa5f32dabade1da0e01c23cb16e160b624565d09a4a2a07fb7f7fd4d45aac88a&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;2&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;0a1eee9a-635a-4391-8b74-75bf3c648f0e&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;document_id&quot;: &quot;FULadzkWmovlfkxSgLPcE4oWnPf&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;b08e60a1cf7fa55aa8c010d792766208dcbb34e58aeead16dca005eab4e1df8f&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;3&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;54c6a119-d914-4690-aa3c-1275d55efe5a&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {},</span>
<span class="line">            &quot;hash&quot;: &quot;06d6c13287ff7e2f033a1aae487198dbfdec3d954aab0fd9b4866ce833200afb&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        }</span>
<span class="line">    },</span>
<span class="line">    &quot;text&quot;: &quot;AGI è¯¾å ‚æ¨å‡ºçš„ç¤¾ç¾¤å‹ä¼šå‘˜åˆ¶è¯¾ç¨‹ï¼Œä¼ æˆå¤§æ¨¡å‹çš„åŸç†ã€åº”ç”¨å¼€å‘æŠ€æœ¯å’Œè¡Œä¸šè®¤çŸ¥ï¼ŒåŠ©ä½ æˆä¸º ChatGPT æµªæ½®ä¸­çš„è¶…çº§ä¸ªä½“\nä»€ä¹ˆæ˜¯ AI&quot;,</span>
<span class="line">    &quot;mimetype&quot;: &quot;text/plain&quot;,</span>
<span class="line">    &quot;start_char_idx&quot;: 33,</span>
<span class="line">    &quot;end_char_idx&quot;: 100,</span>
<span class="line">    &quot;text_template&quot;: &quot;{metadata_str}\n\n{content}&quot;,</span>
<span class="line">    &quot;metadata_template&quot;: &quot;{key}: {value}&quot;,</span>
<span class="line">    &quot;metadata_seperator&quot;: &quot;\n&quot;,</span>
<span class="line">    &quot;class_name&quot;: &quot;TextNode&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>LlamaIndex æä¾›äº†ä¸°å¯Œçš„ <code>TextSplitter</code>ï¼Œä¾‹å¦‚ï¼š</p><ul><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/node_parsers/sentence_splitter/" target="_blank" rel="noopener noreferrer"><code>SentenceSplitter</code></a>ï¼šåœ¨åˆ‡åˆ†æŒ‡å®šé•¿åº¦çš„ chunk åŒæ—¶å°½é‡ä¿è¯å¥å­è¾¹ç•Œä¸è¢«åˆ‡æ–­ï¼›</li><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/node_parsers/code/" target="_blank" rel="noopener noreferrer"><code>CodeSplitter</code></a>ï¼šæ ¹æ® ASTï¼ˆç¼–è¯‘å™¨çš„æŠ½è±¡å¥æ³•æ ‘ï¼‰åˆ‡åˆ†ä»£ç ï¼Œä¿è¯ä»£ç åŠŸèƒ½ç‰‡æ®µå®Œæ•´ï¼›</li><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/node_parsers/semantic_splitter/" target="_blank" rel="noopener noreferrer"><code>SemanticSplitterNodeParser</code></a>ï¼šæ ¹æ®è¯­ä¹‰ç›¸å…³æ€§å¯¹å°†æ–‡æœ¬åˆ‡åˆ†ä¸ºç‰‡æ®µã€‚</li></ul><h3 id="_4-2ã€ä½¿ç”¨-nodeparsers-å¯¹æœ‰ç»“æ„çš„æ–‡æ¡£åšè§£æ" tabindex="-1"><a class="header-anchor" href="#_4-2ã€ä½¿ç”¨-nodeparsers-å¯¹æœ‰ç»“æ„çš„æ–‡æ¡£åšè§£æ"><span>4.2ã€ä½¿ç”¨ NodeParsers å¯¹æœ‰ç»“æ„çš„æ–‡æ¡£åšè§£æ</span></a></h3><p>ä¾‹å¦‚ï¼š<code>MarkdownNodeParser</code>è§£æ markdown æ–‡æ¡£</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token keyword">import</span> FlatReader</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>node_parser <span class="token keyword">import</span> MarkdownNodeParser</span>
<span class="line"><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path</span>
<span class="line"></span>
<span class="line">md_docs <span class="token operator">=</span> FlatReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>load_data<span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token string">&quot;./data/ChatALL.md&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">parser <span class="token operator">=</span> MarkdownNodeParser<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">nodes <span class="token operator">=</span> parser<span class="token punctuation">.</span>get_nodes_from_documents<span class="token punctuation">(</span>md_docs<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">show_json<span class="token punctuation">(</span>nodes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">show_json<span class="token punctuation">(</span>nodes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">{</span>
<span class="line">    &quot;id_&quot;: &quot;5c2eb25f-08ac-4b2e-9050-bc6efa90304a&quot;,</span>
<span class="line">    &quot;embedding&quot;: null,</span>
<span class="line">    &quot;metadata&quot;: {</span>
<span class="line">        &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">        &quot;extension&quot;: &quot;.md&quot;,</span>
<span class="line">        &quot;Header_2&quot;: &quot;åŠŸèƒ½&quot;</span>
<span class="line">    },</span>
<span class="line">    &quot;excluded_embed_metadata_keys&quot;: [],</span>
<span class="line">    &quot;excluded_llm_metadata_keys&quot;: [],</span>
<span class="line">    &quot;relationships&quot;: {</span>
<span class="line">        &quot;1&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;f3be7692-141b-41a6-8b3f-58402aaf36c1&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;4&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">                &quot;extension&quot;: &quot;.md&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;45b9149e0039c1ef7fbbd74f96923875505cc77916de48734ba7767f6a16a87e&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;2&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;3722d2c3-6638-453c-8fe1-f2af97fc8452&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">                &quot;extension&quot;: &quot;.md&quot;,</span>
<span class="line">                &quot;Header_2&quot;: &quot;å±å¹•æˆªå›¾&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;f6065ad5e9929bc7ee14e3c4cc2d29c06788501df8887476c30b279ba8ffd594&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;3&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;c5dcf1d3-7a6a-48b0-b6d8-06457b182ac5&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;Header_2&quot;: &quot;åŠŸèƒ½&quot;,</span>
<span class="line">                &quot;Header_3&quot;: &quot;è¿™æ˜¯ä½ å—ï¼Ÿ&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;f54ac07d417fbcbd606e7cdd3de28c30804e2213218dec2e6157d5037a23e289&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        }</span>
<span class="line">    },</span>
<span class="line">    &quot;text&quot;: &quot;åŠŸèƒ½\n\nåŸºäºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„ AI æœºå™¨äººéå¸¸ç¥å¥‡ã€‚ç„¶è€Œï¼Œå®ƒä»¬çš„è¡Œä¸ºå¯èƒ½æ˜¯éšæœºçš„ï¼Œä¸åŒçš„æœºå™¨äººåœ¨ä¸åŒçš„ä»»åŠ¡ä¸Šè¡¨ç°ä¹Ÿæœ‰å·®å¼‚ã€‚å¦‚æœä½ æƒ³è·å¾—æœ€ä½³ä½“éªŒï¼Œä¸è¦ä¸€ä¸ªä¸€ä¸ªå°è¯•ã€‚ChatALLï¼ˆä¸­æ–‡åï¼šé½å¨ï¼‰å¯ä»¥æŠŠä¸€æ¡æŒ‡ä»¤åŒæ—¶å‘ç»™å¤šä¸ª AIï¼Œå¸®åŠ©æ‚¨å‘ç°æœ€å¥½çš„å›ç­”ã€‚ä½ éœ€è¦åšçš„åªæ˜¯[ä¸‹è½½ã€å®‰è£…](https://github.com/sunner/ChatALL/releases)å’Œæé—®ã€‚&quot;,</span>
<span class="line">    &quot;mimetype&quot;: &quot;text/plain&quot;,</span>
<span class="line">    &quot;start_char_idx&quot;: 459,</span>
<span class="line">    &quot;end_char_idx&quot;: 650,</span>
<span class="line">    &quot;text_template&quot;: &quot;{metadata_str}\n\n{content}&quot;,</span>
<span class="line">    &quot;metadata_template&quot;: &quot;{key}: {value}&quot;,</span>
<span class="line">    &quot;metadata_seperator&quot;: &quot;\n&quot;,</span>
<span class="line">    &quot;class_name&quot;: &quot;TextNode&quot;</span>
<span class="line">}</span>
<span class="line">{</span>
<span class="line">    &quot;id_&quot;: &quot;c5dcf1d3-7a6a-48b0-b6d8-06457b182ac5&quot;,</span>
<span class="line">    &quot;embedding&quot;: null,</span>
<span class="line">    &quot;metadata&quot;: {</span>
<span class="line">        &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">        &quot;extension&quot;: &quot;.md&quot;,</span>
<span class="line">        &quot;Header_2&quot;: &quot;åŠŸèƒ½&quot;,</span>
<span class="line">        &quot;Header_3&quot;: &quot;è¿™æ˜¯ä½ å—ï¼Ÿ&quot;</span>
<span class="line">    },</span>
<span class="line">    &quot;excluded_embed_metadata_keys&quot;: [],</span>
<span class="line">    &quot;excluded_llm_metadata_keys&quot;: [],</span>
<span class="line">    &quot;relationships&quot;: {</span>
<span class="line">        &quot;1&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;f3be7692-141b-41a6-8b3f-58402aaf36c1&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;4&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">                &quot;extension&quot;: &quot;.md&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;45b9149e0039c1ef7fbbd74f96923875505cc77916de48734ba7767f6a16a87e&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;2&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;5c2eb25f-08ac-4b2e-9050-bc6efa90304a&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;filename&quot;: &quot;ChatALL.md&quot;,</span>
<span class="line">                &quot;extension&quot;: &quot;.md&quot;,</span>
<span class="line">                &quot;Header_2&quot;: &quot;åŠŸèƒ½&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;90172566aa1795d0f9ac33c954d0b98fde63bf9176950d0ea38e87e4ab6563ed&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        },</span>
<span class="line">        &quot;3&quot;: {</span>
<span class="line">            &quot;node_id&quot;: &quot;7d959c37-6ff9-4bfe-b499-c509a24088cb&quot;,</span>
<span class="line">            &quot;node_type&quot;: &quot;1&quot;,</span>
<span class="line">            &quot;metadata&quot;: {</span>
<span class="line">                &quot;Header_2&quot;: &quot;åŠŸèƒ½&quot;,</span>
<span class="line">                &quot;Header_3&quot;: &quot;æ”¯æŒçš„ AI&quot;</span>
<span class="line">            },</span>
<span class="line">            &quot;hash&quot;: &quot;1b2b11abec9fc74b725b6c344f37d44736e8e991a3eebdbcfa4ab682506c7b2e&quot;,</span>
<span class="line">            &quot;class_name&quot;: &quot;RelatedNodeInfo&quot;</span>
<span class="line">        }</span>
<span class="line">    },</span>
<span class="line">    &quot;text&quot;: &quot;è¿™æ˜¯ä½ å—ï¼Ÿ\n\nChatALL çš„å…¸å‹ç”¨æˆ·æ˜¯ï¼š\n\n- ğŸ¤ **å¤§æ¨¡å‹é‡åº¦ç©å®¶**ï¼Œå¸Œæœ›ä»å¤§æ¨¡å‹æ‰¾åˆ°æœ€å¥½çš„ç­”æ¡ˆï¼Œæˆ–è€…æœ€å¥½çš„åˆ›ä½œ\n- ğŸ¤“**å¤§æ¨¡å‹ç ”ç©¶è€…**ï¼Œç›´è§‚æ¯”è¾ƒå„ç§å¤§æ¨¡å‹åœ¨ä¸åŒé¢†åŸŸçš„ä¼˜åŠ£\n- ğŸ˜**å¤§æ¨¡å‹åº”ç”¨å¼€å‘è€…**ï¼Œå¿«é€Ÿè°ƒè¯• promptï¼Œå¯»æ‰¾è¡¨ç°æœ€ä½³çš„åŸºç¡€æ¨¡å‹&quot;,</span>
<span class="line">    &quot;mimetype&quot;: &quot;text/plain&quot;,</span>
<span class="line">    &quot;start_char_idx&quot;: 656,</span>
<span class="line">    &quot;end_char_idx&quot;: 788,</span>
<span class="line">    &quot;text_template&quot;: &quot;{metadata_str}\n\n{content}&quot;,</span>
<span class="line">    &quot;metadata_template&quot;: &quot;{key}: {value}&quot;,</span>
<span class="line">    &quot;metadata_seperator&quot;: &quot;\n&quot;,</span>
<span class="line">    &quot;class_name&quot;: &quot;TextNode&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å¤šçš„ <code>NodeParser</code> åŒ…æ‹¬ <a href="https://docs.llamaindex.ai/en/stable/api_reference/node_parsers/html/" target="_blank" rel="noopener noreferrer"><code>HTMLNodeParser</code></a>ï¼Œ<a href="https://docs.llamaindex.ai/en/stable/api_reference/node_parsers/json/" target="_blank" rel="noopener noreferrer"><code>JSONNodeParser</code></a>ç­‰ç­‰ã€‚</p><h2 id="_5ã€ç´¢å¼•-indexing-ä¸æ£€ç´¢-retrieval" tabindex="-1"><a class="header-anchor" href="#_5ã€ç´¢å¼•-indexing-ä¸æ£€ç´¢-retrieval"><span>5ã€ç´¢å¼•ï¼ˆIndexingï¼‰ä¸æ£€ç´¢ï¼ˆRetrievalï¼‰</span></a></h2><p><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šåœ¨ã€Œæ£€ç´¢ã€ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œã€Œç´¢å¼•ã€å³<code>index</code>ï¼Œ é€šå¸¸æ˜¯æŒ‡ä¸ºäº†å®ç°å¿«é€Ÿæ£€ç´¢è€Œè®¾è®¡çš„ç‰¹å®šã€Œæ•°æ®ç»“æ„ã€ã€‚</p><p>ç´¢å¼•çš„å…·ä½“åŸç†ä¸å®ç°ä¸æ˜¯æœ¬è¯¾ç¨‹çš„æ•™å­¦é‡ç‚¹ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒï¼š<a href="https://en.wikipedia.org/wiki/Search_engine_indexing" target="_blank" rel="noopener noreferrer">ä¼ ç»Ÿç´¢å¼•</a>ã€<a href="https://medium.com/kx-systems/vector-indexing-a-roadmap-for-vector-databases-65866f07daf5" target="_blank" rel="noopener noreferrer">å‘é‡ç´¢å¼•</a></p><h3 id="_5-1ã€å‘é‡æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_5-1ã€å‘é‡æ£€ç´¢"><span>5.1ã€å‘é‡æ£€ç´¢</span></a></h3><ol><li><code>SimpleVectorStore</code> ç›´æ¥åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ª Vector Store å¹¶å»ºç´¢å¼•</li></ol><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> VectorStoreIndex<span class="token punctuation">,</span> SimpleDirectoryReader</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>node_parser <span class="token keyword">import</span> TokenTextSplitter</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token keyword">import</span> PyMuPDFReader</span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½ pdf æ–‡æ¡£</span></span>
<span class="line">documents <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;./data&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    required_exts<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    file_extractor<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">:</span> PyMuPDFReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®šä¹‰ Node Parser</span></span>
<span class="line">node_parser <span class="token operator">=</span> TokenTextSplitter<span class="token punctuation">(</span>chunk_size<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> chunk_overlap<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ‡åˆ†æ–‡æ¡£</span></span>
<span class="line">nodes <span class="token operator">=</span> node_parser<span class="token punctuation">.</span>get_nodes_from_documents<span class="token punctuation">(</span>documents<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ„å»º index</span></span>
<span class="line">index <span class="token operator">=</span> VectorStoreIndex<span class="token punctuation">(</span>nodes<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å– retriever</span></span>
<span class="line">vector_retriever <span class="token operator">=</span> index<span class="token punctuation">.</span>as_retriever<span class="token punctuation">(</span></span>
<span class="line">    similarity_top_k<span class="token operator">=</span><span class="token number">2</span> <span class="token comment"># è¿”å›2ä¸ªç»“æœ</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€ç´¢</span></span>
<span class="line">results <span class="token operator">=</span> vector_retriever<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span><span class="token string">&quot;Llama2æœ‰å¤šå°‘å‚æ•°&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">an updated version of Llama 1, trained on a new mix of publicly available data. We also</span>
<span class="line">increased the size of the pretraining corpus by 40%, doubled the context length of the model, and</span>
<span class="line">adopted grouped-query attention (Ainslie et al., 2023). We are releasing variants of Llama 2 with</span>
<span class="line">7B, 13B, and 70B parameters. We have also trained 34B variants, which we report on in this paper</span>
<span class="line">but are not releasing.Â§</span>
<span class="line">2. Llama 2-Chat, a fine-tuned version of Llama 2 that is optimized for dialogue use cases. We release</span>
<span class="line">variants of this model with 7B, 13B, and 70B parameters as well.</span>
<span class="line">We believe that the open release of LLMs, when done safely, will be a net benefit to society. Like all LLMs,</span>
<span class="line">Llama 2 is a new technology that carries potential risks with use (Bender et al., 2021b; Weidinger et al., 2021;</span>
<span class="line">Solaiman et al., 2023). Testing conducted to date has been in English and has not â€” and could not â€” cover</span>
<span class="line">all scenarios. Therefore, before deploying any applications of</span>
<span class="line"></span>
<span class="line">Koura Marie-Anne Lachaux Thibaut Lavril Jenya Lee Diana Liskovich</span>
<span class="line">Yinghai Lu Yuning Mao Xavier Martinet Todor Mihaylov Pushkar Mishra</span>
<span class="line">Igor Molybog Yixin Nie Andrew Poulton Jeremy Reizenstein Rashi Rungta Kalyan Saladi</span>
<span class="line">Alan Schelten Ruan Silva Eric Michael Smith Ranjan Subramanian Xiaoqing Ellen Tan Binh Tang</span>
<span class="line">Ross Taylor Adina Williams Jian Xiang Kuan Puxin Xu Zheng Yan Iliyan Zarov Yuchen Zhang</span>
<span class="line">Angela Fan Melanie Kambadur Sharan Narang Aurelien Rodriguez Robert Stojnic</span>
<span class="line">Sergey Edunov</span>
<span class="line">Thomas Scialomâˆ—</span>
<span class="line">GenAI, Meta</span>
<span class="line">Abstract</span>
<span class="line">In this work, we develop and release Llama 2, a collection of pretrained and fine-tuned</span>
<span class="line">large language models (LLMs) ranging in scale from 7 billion to 70 billion parameters.</span>
<span class="line">Our fine-tuned LLMs, called Llama 2-Chat, are optimized for dialogue use cases. Our</span>
<span class="line">models outperform open-source chat models on most benchmarks we tested, and based on</span>
<span class="line">our human evaluations for helpfulness and safety, may be a suitable substitute for</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âš ï¸ <strong>Note:</strong> LlamaIndex é»˜è®¤çš„ Embedding æ¨¡å‹æ˜¯ OpenAIEmbedding(model=&quot;text-embedding-ada-002&quot;)ã€‚ å¦‚ä½•æ›¿æ¢æŒ‡å®šçš„ Embedding æ¨¡å‹è§åé¢ç« èŠ‚è¯¦è§£ã€‚</p></blockquote><ol start="2"><li>ä½¿ç”¨è‡ªå®šä¹‰çš„ Vector Storeï¼Œä»¥ <code>Qdrant</code> ä¸ºä¾‹ï¼š</li></ol><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">!pip install llama<span class="token operator">-</span>index<span class="token operator">-</span>vector<span class="token operator">-</span>stores<span class="token operator">-</span>qdrant</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>vector_store<span class="token punctuation">.</span>base <span class="token keyword">import</span> VectorStoreIndex</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>vector_stores<span class="token punctuation">.</span>qdrant <span class="token keyword">import</span> QdrantVectorStore</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> StorageContext</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> qdrant_client <span class="token keyword">import</span> QdrantClient</span>
<span class="line"><span class="token keyword">from</span> qdrant_client<span class="token punctuation">.</span>models <span class="token keyword">import</span> VectorParams<span class="token punctuation">,</span> Distance</span>
<span class="line"></span>
<span class="line">client <span class="token operator">=</span> QdrantClient<span class="token punctuation">(</span>location<span class="token operator">=</span><span class="token string">&quot;:memory:&quot;</span><span class="token punctuation">)</span></span>
<span class="line">collection_name <span class="token operator">=</span> <span class="token string">&quot;demo&quot;</span></span>
<span class="line">collection <span class="token operator">=</span> client<span class="token punctuation">.</span>create_collection<span class="token punctuation">(</span></span>
<span class="line">    collection_name<span class="token operator">=</span>collection_name<span class="token punctuation">,</span></span>
<span class="line">    vectors_config<span class="token operator">=</span>VectorParams<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">1536</span><span class="token punctuation">,</span> distance<span class="token operator">=</span>Distance<span class="token punctuation">.</span>COSINE<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">vector_store <span class="token operator">=</span> QdrantVectorStore<span class="token punctuation">(</span>client<span class="token operator">=</span>client<span class="token punctuation">,</span> collection_name<span class="token operator">=</span>collection_name<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># storage: æŒ‡å®šå­˜å‚¨ç©ºé—´</span></span>
<span class="line">storage_context <span class="token operator">=</span> StorageContext<span class="token punctuation">.</span>from_defaults<span class="token punctuation">(</span>vector_store<span class="token operator">=</span>vector_store<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»º indexï¼šé€šè¿‡ Storage Context å…³è”åˆ°è‡ªå®šä¹‰çš„ Vector Store</span></span>
<span class="line">index <span class="token operator">=</span> VectorStoreIndex<span class="token punctuation">(</span>nodes<span class="token punctuation">,</span> storage_context<span class="token operator">=</span>storage_context<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å– retriever</span></span>
<span class="line">vector_retriever <span class="token operator">=</span> index<span class="token punctuation">.</span>as_retriever<span class="token punctuation">(</span>similarity_top_k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€ç´¢</span></span>
<span class="line">results <span class="token operator">=</span> vector_retriever<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span><span class="token string">&quot;Llama2æœ‰å¤šå°‘å‚æ•°&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Node ID: bd3ff0be-13b9-4f7c-bac3-71ef38978766</span>
<span class="line">Text: an updated version of Llama 1, trained on a new mix of publicly</span>
<span class="line">available data. We also increased the size of the pretraining corpus</span>
<span class="line">by 40%, doubled the context length of the model, and adopted grouped-</span>
<span class="line">query attention (Ainslie et al., 2023). We are releasing variants of</span>
<span class="line">Llama 2 with 7B, 13B, and 70B parameters. We have also trained 34B</span>
<span class="line">variants,...</span>
<span class="line">Score:  0.790</span>
<span class="line"></span>
<span class="line">Node ID: 18282125-5744-4da8-afe6-32b208304571</span>
<span class="line">Text: Koura Marie-Anne Lachaux Thibaut Lavril Jenya Lee Diana</span>
<span class="line">Liskovich Yinghai Lu Yuning Mao Xavier Martinet Todor Mihaylov Pushkar</span>
<span class="line">Mishra Igor Molybog Yixin Nie Andrew Poulton Jeremy Reizenstein Rashi</span>
<span class="line">Rungta Kalyan Saladi Alan Schelten Ruan Silva Eric Michael Smith</span>
<span class="line">Ranjan Subramanian Xiaoqing Ellen Tan Binh Tang Ross Taylor Adina</span>
<span class="line">Williams Jian Xiang...</span>
<span class="line">Score:  0.789</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2ã€æ›´å¤šç´¢å¼•ä¸æ£€ç´¢æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_5-2ã€æ›´å¤šç´¢å¼•ä¸æ£€ç´¢æ–¹å¼"><span>5.2ã€æ›´å¤šç´¢å¼•ä¸æ£€ç´¢æ–¹å¼</span></a></h3><p>LlamaIndex å†…ç½®äº†ä¸°å¯Œçš„æ£€ç´¢æœºåˆ¶ï¼Œä¾‹å¦‚ï¼š</p><ul><li><p>å…³é”®å­—æ£€ç´¢</p><ul><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/bm25/" target="_blank" rel="noopener noreferrer"><code>BM25Retriever</code></a>ï¼šåŸºäº tokenizer å®ç°çš„ BM25 ç»å…¸æ£€ç´¢ç®—æ³•</li><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/keyword/#llama_index.core.indices.keyword_table.retrievers.KeywordTableGPTRetriever" target="_blank" rel="noopener noreferrer"><code>KeywordTableGPTRetriever</code></a>ï¼šä½¿ç”¨ GPT æå–æ£€ç´¢å…³é”®å­—</li><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/keyword/#llama_index.core.indices.keyword_table.retrievers.KeywordTableSimpleRetriever" target="_blank" rel="noopener noreferrer"><code>KeywordTableSimpleRetriever</code></a>ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–æ£€ç´¢å…³é”®å­—</li><li><a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/keyword/#llama_index.core.indices.keyword_table.retrievers.KeywordTableRAKERetriever" target="_blank" rel="noopener noreferrer"><code>KeywordTableRAKERetriever</code></a>ï¼šä½¿ç”¨<a href="https://pypi.org/project/rake-nltk/" target="_blank" rel="noopener noreferrer"><code>RAKE</code></a>ç®—æ³•æå–æ£€ç´¢å…³é”®å­—ï¼ˆæœ‰è¯­è¨€é™åˆ¶ï¼‰</li></ul></li><li><p>RAG-Fusion <a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/query_fusion/" target="_blank" rel="noopener noreferrer"><code>QueryFusionRetriever</code></a></p></li><li><p>è¿˜æ”¯æŒ <a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/knowledge_graph/" target="_blank" rel="noopener noreferrer">KnowledgeGraph</a>ã€<a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/sql/#llama_index.core.retrievers.SQLRetriever" target="_blank" rel="noopener noreferrer">SQL</a>ã€<a href="https://docs.llamaindex.ai/en/stable/api_reference/retrievers/sql/#llama_index.core.retrievers.NLSQLRetriever" target="_blank" rel="noopener noreferrer">Text-to-SQL</a> ç­‰ç­‰</p></li></ul><h3 id="_5-3ã€ingestion-pipeline-è‡ªå®šä¹‰æ•°æ®å¤„ç†æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_5-3ã€ingestion-pipeline-è‡ªå®šä¹‰æ•°æ®å¤„ç†æµç¨‹"><span>5.3ã€Ingestion Pipeline è‡ªå®šä¹‰æ•°æ®å¤„ç†æµç¨‹</span></a></h3><p>LlamaIndex é€šè¿‡ <code>Transformations</code> å®šä¹‰ä¸€ä¸ªæ•°æ®ï¼ˆ<code>Documents</code>ï¼‰çš„å¤šæ­¥å¤„ç†çš„æµç¨‹ï¼ˆPipelineï¼‰ã€‚ è¿™ä¸ª Pipeline çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹æ˜¯ï¼Œ<strong>å®ƒçš„æ¯ä¸ªå­æ­¥éª¤æ˜¯å¯ä»¥ç¼“å­˜ï¼ˆcacheï¼‰çš„</strong>ï¼Œå³å¦‚æœè¯¥å­æ­¥éª¤çš„è¾“å…¥ä¸å¤„ç†æ–¹æ³•ä¸å˜ï¼Œé‡å¤è°ƒç”¨æ—¶ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è·å–ç»“æœï¼Œè€Œæ— éœ€é‡æ–°æ‰§è¡Œè¯¥å­æ­¥éª¤ï¼Œè¿™æ ·å³èŠ‚çœæ—¶é—´ä¹Ÿä¼šèŠ‚çœ token ï¼ˆå¦‚æœå­æ­¥éª¤æ¶‰åŠå¤§æ¨¡å‹è°ƒç”¨ï¼‰ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Timer</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> self</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>interval <span class="token operator">=</span> self<span class="token punctuation">.</span>end <span class="token operator">-</span> self<span class="token punctuation">.</span>start</span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;è€—æ—¶ </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>interval<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">}</span></span><span class="token string"> ms&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>vector_store<span class="token punctuation">.</span>base <span class="token keyword">import</span> VectorStoreIndex</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>vector_stores<span class="token punctuation">.</span>qdrant <span class="token keyword">import</span> QdrantVectorStore</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> StorageContext</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> qdrant_client <span class="token keyword">import</span> QdrantClient</span>
<span class="line"><span class="token keyword">from</span> qdrant_client<span class="token punctuation">.</span>models <span class="token keyword">import</span> VectorParams<span class="token punctuation">,</span> Distance</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>openai <span class="token keyword">import</span> OpenAIEmbedding</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>node_parser <span class="token keyword">import</span> SentenceSplitter</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>extractors <span class="token keyword">import</span> TitleExtractor</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ingestion <span class="token keyword">import</span> IngestionPipeline</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> VectorStoreIndex</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token keyword">import</span> PyMuPDFReader</span>
<span class="line"><span class="token keyword">import</span> nest_asyncio</span>
<span class="line">nest_asyncio<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># åªåœ¨Jupyterç¬”è®°ç¯å¢ƒä¸­éœ€è¦æ­¤æ“ä½œï¼Œå¦åˆ™ä¼šæŠ¥é”™</span></span>
<span class="line"></span>
<span class="line">client <span class="token operator">=</span> QdrantClient<span class="token punctuation">(</span>location<span class="token operator">=</span><span class="token string">&quot;:memory:&quot;</span><span class="token punctuation">)</span></span>
<span class="line">collection_name <span class="token operator">=</span> <span class="token string">&quot;ingestion_demo&quot;</span></span>
<span class="line"></span>
<span class="line">collection <span class="token operator">=</span> client<span class="token punctuation">.</span>create_collection<span class="token punctuation">(</span></span>
<span class="line">    collection_name<span class="token operator">=</span>collection_name<span class="token punctuation">,</span></span>
<span class="line">    vectors_config<span class="token operator">=</span>VectorParams<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">1536</span><span class="token punctuation">,</span> distance<span class="token operator">=</span>Distance<span class="token punctuation">.</span>COSINE<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»º Vector Store</span></span>
<span class="line">vector_store <span class="token operator">=</span> QdrantVectorStore<span class="token punctuation">(</span>client<span class="token operator">=</span>client<span class="token punctuation">,</span> collection_name<span class="token operator">=</span>collection_name<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">pipeline <span class="token operator">=</span> IngestionPipeline<span class="token punctuation">(</span></span>
<span class="line">    transformations<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="line">        SentenceSplitter<span class="token punctuation">(</span>chunk_size<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> chunk_overlap<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># æŒ‰å¥å­åˆ‡åˆ†</span></span>
<span class="line">        TitleExtractor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># åˆ©ç”¨ LLM å¯¹æ–‡æœ¬ç”Ÿæˆæ ‡é¢˜</span></span>
<span class="line">        OpenAIEmbedding<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># å°†æ–‡æœ¬å‘é‡åŒ–</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    vector_store<span class="token operator">=</span>vector_store<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">documents <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;./data&quot;</span><span class="token punctuation">,</span> </span>
<span class="line">    required_exts<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    file_extractor<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">:</span> PyMuPDFReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¡æ—¶</span></span>
<span class="line"><span class="token keyword">with</span> Timer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># Ingest directly into a vector db</span></span>
<span class="line">    pipeline<span class="token punctuation">.</span>run<span class="token punctuation">(</span>documents<span class="token operator">=</span>documents<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºç´¢å¼•</span></span>
<span class="line">index <span class="token operator">=</span> VectorStoreIndex<span class="token punctuation">.</span>from_vector_store<span class="token punctuation">(</span>vector_store<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># è·å– retriever</span></span>
<span class="line">vector_retriever <span class="token operator">=</span> index<span class="token punctuation">.</span>as_retriever<span class="token punctuation">(</span>similarity_top_k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€ç´¢</span></span>
<span class="line">results <span class="token operator">=</span> vector_retriever<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span><span class="token string">&quot;Llama2æœ‰å¤šå°‘å‚æ•°&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:01&lt;00:00,  2.99it/s]</span>
<span class="line">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00&lt;00:00,  5.62it/s]</span>
<span class="line">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00&lt;00:00,  5.85it/s]</span>
<span class="line">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:02&lt;00:00,  1.68it/s]</span>
<span class="line">è€—æ—¶ 8875.431299209595 ms</span>
<span class="line">Node ID: b48b5c44-9287-4056-bdae-f8dc1393d44d</span>
<span class="line">Text: Llama 2, an updated version of Llama 1, trained on a new mix of</span>
<span class="line">publicly available data. We also increased the size of the pretraining</span>
<span class="line">corpus by 40%, doubled the context length of the model, and adopted</span>
<span class="line">grouped-query attention (Ainslie et al., 2023). We are releasing</span>
<span class="line">variants of Llama 2 with 7B, 13B, and 70B parameters. We have also</span>
<span class="line">trained 34B ...</span>
<span class="line">Score:  0.783</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ¬åœ°ä¿å­˜ <code>IngestionPipeline</code> çš„ç¼“å­˜</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">pipeline<span class="token punctuation">.</span>persist<span class="token punctuation">(</span><span class="token string">&quot;./pipeline_storage&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">new_pipeline <span class="token operator">=</span> IngestionPipeline<span class="token punctuation">(</span></span>
<span class="line">    transformations<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="line">        SentenceSplitter<span class="token punctuation">(</span>chunk_size<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> chunk_overlap<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        TitleExtractor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åŠ è½½ç¼“å­˜</span></span>
<span class="line">new_pipeline<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;./pipeline_storage&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> Timer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    nodes <span class="token operator">=</span> new_pipeline<span class="token punctuation">.</span>run<span class="token punctuation">(</span>documents<span class="token operator">=</span>documents<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">è€—æ—¶ 3.515005111694336 ms</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨è¿œç¨‹çš„ Redis æˆ– MongoDB ç­‰å­˜å‚¨ <code>IngestionPipeline</code> çš„ç¼“å­˜ï¼Œå…·ä½“å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.llamaindex.ai/en/stable/module_guides/loading/ingestion_pipeline/#remote-cache-management" target="_blank" rel="noopener noreferrer">Remote Cache Management</a>ã€‚</p><p><code>IngestionPipeline</code> ä¹Ÿæ”¯æŒå¼‚æ­¥å’Œå¹¶å‘è°ƒç”¨ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.llamaindex.ai/en/stable/module_guides/loading/ingestion_pipeline/#async-support" target="_blank" rel="noopener noreferrer">Async Support</a>ã€<a href="https://docs.llamaindex.ai/en/stable/module_guides/loading/ingestion_pipeline/#parallel-processing" target="_blank" rel="noopener noreferrer">Parallel Processing</a>ã€‚</p><h3 id="_5-4ã€æ£€ç´¢åå¤„ç†" tabindex="-1"><a class="header-anchor" href="#_5-4ã€æ£€ç´¢åå¤„ç†"><span>5.4ã€æ£€ç´¢åå¤„ç†</span></a></h3><p>LlamaIndex çš„ <code>Node Postprocessors</code> æä¾›äº†ä¸€ç³»åˆ—æ£€ç´¢åå¤„ç†æ¨¡å—ã€‚</p><p>ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯ä»¥ç”¨ä¸åŒæ¨¡å‹å¯¹æ£€ç´¢åçš„ <code>Nodes</code> åšé‡æ’åº</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># è·å– retriever</span></span>
<span class="line">vector_retriever <span class="token operator">=</span> index<span class="token punctuation">.</span>as_retriever<span class="token punctuation">(</span>similarity_top_k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€ç´¢</span></span>
<span class="line">nodes <span class="token operator">=</span> vector_retriever<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span><span class="token string">&quot;Llama2 æœ‰å•†ç”¨è®¸å¯å—?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> node <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>node<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">[0] Llama 2, an updated version of Llama 1, trained on a new mix of publicly available data. We also</span>
<span class="line">increased the size of the pretraining corpus by 40%, doubled the context length of the model, and</span>
<span class="line">adopted grouped-query attention (Ainslie et al., 2023). We are releasing variants of Llama 2 with</span>
<span class="line">7B, 13B, and 70B parameters. We have also trained 34B variants, which we report on in this paper</span>
<span class="line">but are not releasing.Â§</span>
<span class="line">2. Llama 2-Chat, a fine-tuned version of Llama 2 that is optimized for dialogue use cases. We release</span>
<span class="line">variants of this model with 7B, 13B, and 70B parameters as well.</span>
<span class="line">We believe that the open release of LLMs, when done safely, will be a net benefit to society. Like all LLMs,</span>
<span class="line">Llama 2 is a new technology that carries potential risks with use (Bender et al., 2021b; Weidinger et al., 2021;</span>
<span class="line">Solaiman et al., 2023).</span>
<span class="line"></span>
<span class="line">[1] We release</span>
<span class="line">variants of this model with 7B, 13B, and 70B parameters as well.</span>
<span class="line">We believe that the open release of LLMs, when done safely, will be a net benefit to society. Like all LLMs,</span>
<span class="line">Llama 2 is a new technology that carries potential risks with use (Bender et al., 2021b; Weidinger et al., 2021;</span>
<span class="line">Solaiman et al., 2023). Testing conducted to date has been in English and has not â€” and could not â€” cover</span>
<span class="line">all scenarios. Therefore, before deploying any applications of Llama 2-Chat, developers should perform</span>
<span class="line">safety testing and tuning tailored to their specific applications of the model. We provide a responsible use</span>
<span class="line">guideÂ¶ and code examplesâ€– to facilitate the safe deployment of Llama 2 and Llama 2-Chat. More details of</span>
<span class="line">our responsible release strategy can be found in Section 5.3.</span>
<span class="line"></span>
<span class="line">[2] Marie-Anne Lachaux Thibaut Lavril Jenya Lee Diana Liskovich</span>
<span class="line">Yinghai Lu Yuning Mao Xavier Martinet Todor Mihaylov Pushkar Mishra</span>
<span class="line">Igor Molybog Yixin Nie Andrew Poulton Jeremy Reizenstein Rashi Rungta Kalyan Saladi</span>
<span class="line">Alan Schelten Ruan Silva Eric Michael Smith Ranjan Subramanian Xiaoqing Ellen Tan Binh Tang</span>
<span class="line">Ross Taylor Adina Williams Jian Xiang Kuan Puxin Xu Zheng Yan Iliyan Zarov Yuchen Zhang</span>
<span class="line">Angela Fan Melanie Kambadur Sharan Narang Aurelien Rodriguez Robert Stojnic</span>
<span class="line">Sergey Edunov</span>
<span class="line">Thomas Scialomâˆ—</span>
<span class="line">GenAI, Meta</span>
<span class="line">Abstract</span>
<span class="line">In this work, we develop and release Llama 2, a collection of pretrained and fine-tuned</span>
<span class="line">large language models (LLMs) ranging in scale from 7 billion to 70 billion parameters.</span>
<span class="line">Our fine-tuned LLMs, called Llama 2-Chat, are optimized for dialogue use cases.</span>
<span class="line"></span>
<span class="line">[3] These closed product LLMs are heavily fine-tuned to align with human</span>
<span class="line">preferences, which greatly enhances their usability and safety. This step can require significant costs in</span>
<span class="line">compute and human annotation, and is often not transparent or easily reproducible, limiting progress within</span>
<span class="line">the community to advance AI alignment research.</span>
<span class="line">In this work, we develop and release Llama 2, a family of pretrained and fine-tuned LLMs, Llama 2 and</span>
<span class="line">Llama 2-Chat, at scales up to 70B parameters. On the series of helpfulness and safety benchmarks we tested,</span>
<span class="line">Llama 2-Chat models generally perform better than existing open-source models. They also appear to</span>
<span class="line">be on par with some of the closed-source models, at least on the human evaluations we performed (see</span>
<span class="line">Figures 1 and 3). We have taken measures to increase the safety of these models, using safety-specific data</span>
<span class="line">annotation and tuning, as well as conducting red-teaming and employing iterative evaluations. Additionally,</span>
<span class="line">this paper contributes a thorough description of our fine-tuning methodology and approach to improving</span>
<span class="line">LLM safety.</span>
<span class="line"></span>
<span class="line">[4] Figure 3: Safety human evaluation results for Llama 2-Chat compared to other open-source and closed-</span>
<span class="line">source models. Human raters judged model generations for safety violations across ~2,000 adversarial</span>
<span class="line">prompts consisting of both single and multi-turn prompts. More details can be found in Section 4.4. It is</span>
<span class="line">important to caveat these safety results with the inherent bias of LLM evaluations due to limitations of the</span>
<span class="line">prompt set, subjectivity of the review guidelines, and subjectivity of individual raters. Additionally, these</span>
<span class="line">safety evaluations are performed using content standards that are likely to be biased towards the Llama</span>
<span class="line">2-Chat models.</span>
<span class="line">We are releasing the following models to the general public for research and commercial useâ€¡:</span>
<span class="line">1. Llama 2, an updated version of Llama 1, trained on a new mix of publicly available data. We also</span>
<span class="line">increased the size of the pretraining corpus by 40%, doubled the context length of the model, and</span>
<span class="line">adopted grouped-query attention (Ainslie et al., 2023). We are releasing variants of Llama 2 with</span>
<span class="line">7B, 13B, and 70B parameters.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âŒ <strong>Warning:</strong> ä»¥ä¸‹ä»£ç ä¸è¦åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä¼šæ­»æœºï¼ å¯ä¸‹è½½å·¦ä¾§ rag_demo.py çš„å®Œæ•´ä¾‹å­åœ¨è‡ªå·±æœ¬åœ°è¿è¡Œã€‚</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>postprocessor <span class="token keyword">import</span> SentenceTransformerRerank</span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ£€ç´¢åæ’åºæ¨¡å‹</span></span>
<span class="line">postprocessor <span class="token operator">=</span> SentenceTransformerRerank<span class="token punctuation">(</span></span>
<span class="line">    model<span class="token operator">=</span><span class="token string">&quot;BAAI/bge-reranker-large&quot;</span><span class="token punctuation">,</span> top_n<span class="token operator">=</span><span class="token number">2</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">nodes <span class="token operator">=</span> postprocessor<span class="token punctuation">.</span>postprocess_nodes<span class="token punctuation">(</span>nodes<span class="token punctuation">,</span> query_str<span class="token operator">=</span><span class="token string">&quot;Llama2 æœ‰å•†ç”¨è®¸å¯å—?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> i<span class="token punctuation">,</span> node <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>node<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">/opt/conda/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html</span>
<span class="line">  from .autonotebook import tqdm as notebook_tqdm</span>
<span class="line">/home/jovyan/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.</span>
<span class="line">  warnings.warn(</span>
<span class="line">[0] Figure 3: Safety human evaluation results for Llama 2-Chat compared to other open-source and closed-</span>
<span class="line">source models. Human raters judged model generations for safety violations across ~2,000 adversarial</span>
<span class="line">prompts consisting of both single and multi-turn prompts. More details can be found in Section 4.4. It is</span>
<span class="line">important to caveat these safety results with the inherent bias of LLM evaluations due to limitations of the</span>
<span class="line">prompt set, subjectivity of the review guidelines, and subjectivity of individual raters. Additionally, these</span>
<span class="line">safety evaluations are performed using content standards that are likely to be biased towards the Llama</span>
<span class="line">2-Chat models.</span>
<span class="line">We are releasing the following models to the general public for research and commercial useâ€¡:</span>
<span class="line">1. Llama 2, an updated version of Llama 1, trained on a new mix of publicly available data. We also</span>
<span class="line">increased the size of the pretraining corpus by 40%, doubled the context length of the model, and</span>
<span class="line">adopted grouped-query attention (Ainslie et al., 2023). We are releasing variants of Llama 2 with</span>
<span class="line">7B, 13B, and 70B parameters.</span>
<span class="line">[1] Llama 2, an updated version of Llama 1, trained on a new mix of publicly available data. We also</span>
<span class="line">increased the size of the pretraining corpus by 40%, doubled the context length of the model, and</span>
<span class="line">adopted grouped-query attention (Ainslie et al., 2023). We are releasing variants of Llama 2 with</span>
<span class="line">7B, 13B, and 70B parameters. We have also trained 34B variants, which we report on in this paper</span>
<span class="line">but are not releasing.Â§</span>
<span class="line">2. Llama 2-Chat, a fine-tuned version of Llama 2 that is optimized for dialogue use cases. We release</span>
<span class="line">variants of this model with 7B, 13B, and 70B parameters as well.</span>
<span class="line">We believe that the open release of LLMs, when done safely, will be a net benefit to society. Like all LLMs,</span>
<span class="line">Llama 2 is a new technology that carries potential risks with use (Bender et al., 2021b; Weidinger et al., 2021;</span>
<span class="line">Solaiman et al., 2023).</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å¤šçš„ Rerank åŠå…¶å®ƒåå¤„ç†æ–¹æ³•ï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.llamaindex.ai/en/stable/module_guides/querying/node_postprocessors/node_postprocessors/" target="_blank" rel="noopener noreferrer">Node Postprocessor Modules</a></p><h2 id="_6ã€ç”Ÿæˆå›å¤-qa-chat" tabindex="-1"><a class="header-anchor" href="#_6ã€ç”Ÿæˆå›å¤-qa-chat"><span>6ã€ç”Ÿæˆå›å¤ï¼ˆQA &amp; Chatï¼‰</span></a></h2><h3 id="_6-1ã€å•è½®é—®ç­”-query-engine" tabindex="-1"><a class="header-anchor" href="#_6-1ã€å•è½®é—®ç­”-query-engine"><span>6.1ã€å•è½®é—®ç­”ï¼ˆQuery Engineï¼‰</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">qa_engine <span class="token operator">=</span> index<span class="token punctuation">.</span>as_query_engine<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">response <span class="token operator">=</span> qa_engine<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;Llama2 æœ‰å¤šå°‘å‚æ•°?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2æœ‰7B, 13B, å’Œ70Bå‚æ•°ã€‚</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="æµå¼è¾“å‡º" tabindex="-1"><a class="header-anchor" href="#æµå¼è¾“å‡º"><span>æµå¼è¾“å‡º</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">qa_engine <span class="token operator">=</span> index<span class="token punctuation">.</span>as_query_engine<span class="token punctuation">(</span>streaming<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">response <span class="token operator">=</span> qa_engine<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;Llama2 æœ‰å¤šå°‘å‚æ•°?&quot;</span><span class="token punctuation">)</span></span>
<span class="line">response<span class="token punctuation">.</span>print_response_stream<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2æœ‰7B, 13B, å’Œ70Bå‚æ•°ã€‚</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_6-2ã€å¤šè½®å¯¹è¯-chat-engine" tabindex="-1"><a class="header-anchor" href="#_6-2ã€å¤šè½®å¯¹è¯-chat-engine"><span>6.2ã€å¤šè½®å¯¹è¯ï¼ˆChat Engineï¼‰</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">chat_engine <span class="token operator">=</span> index<span class="token punctuation">.</span>as_chat_engine<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">response <span class="token operator">=</span> chat_engine<span class="token punctuation">.</span>chat<span class="token punctuation">(</span><span class="token string">&quot;Llama2 æœ‰å¤šå°‘å‚æ•°?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama2 æœ‰7B, 13B, å’Œ70Bå‚æ•°ã€‚</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">response <span class="token operator">=</span> chat_engine<span class="token punctuation">.</span>chat<span class="token punctuation">(</span><span class="token string">&quot;How many at most?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama2 æœ€å¤šæœ‰70Bå‚æ•°ã€‚</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="æµå¼è¾“å‡º-1" tabindex="-1"><a class="header-anchor" href="#æµå¼è¾“å‡º-1"><span>æµå¼è¾“å‡º</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">chat_engine <span class="token operator">=</span> index<span class="token punctuation">.</span>as_chat_engine<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">streaming_response <span class="token operator">=</span> chat_engine<span class="token punctuation">.</span>stream_chat<span class="token punctuation">(</span><span class="token string">&quot;Llama 2æœ‰å¤šå°‘å‚æ•°?&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># streaming_response.print_response_stream()</span></span>
<span class="line"><span class="token keyword">for</span> token <span class="token keyword">in</span> streaming_response<span class="token punctuation">.</span>response_gen<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Llama 2æœ‰7Bã€13Bå’Œ70Bå‚æ•°å˜ä½“ã€‚</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_7ã€åº•å±‚æ¥å£-promptã€llm-ä¸-embedding" tabindex="-1"><a class="header-anchor" href="#_7ã€åº•å±‚æ¥å£-promptã€llm-ä¸-embedding"><span>7ã€åº•å±‚æ¥å£ï¼šPromptã€LLM ä¸ Embedding</span></a></h2><h3 id="_7-1ã€prompt-æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#_7-1ã€prompt-æ¨¡æ¿"><span>7.1ã€Prompt æ¨¡æ¿</span></a></h3><h4 id="prompttemplate-å®šä¹‰æç¤ºè¯æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#prompttemplate-å®šä¹‰æç¤ºè¯æ¨¡æ¿"><span><code>PromptTemplate</code> å®šä¹‰æç¤ºè¯æ¨¡æ¿</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> PromptTemplate</span>
<span class="line"></span>
<span class="line">prompt <span class="token operator">=</span> PromptTemplate<span class="token punctuation">(</span><span class="token string">&quot;å†™ä¸€ä¸ªå…³äº{topic}çš„ç¬‘è¯&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">prompt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>topic<span class="token operator">=</span><span class="token string">&quot;å°æ˜&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">&#39;å†™ä¸€ä¸ªå…³äºå°æ˜çš„ç¬‘è¯&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="chatprompttemplate-å®šä¹‰å¤šè½®æ¶ˆæ¯æ¨¡æ¿" tabindex="-1"><a class="header-anchor" href="#chatprompttemplate-å®šä¹‰å¤šè½®æ¶ˆæ¯æ¨¡æ¿"><span><code>ChatPromptTemplate</code> å®šä¹‰å¤šè½®æ¶ˆæ¯æ¨¡æ¿</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>llms <span class="token keyword">import</span> ChatMessage<span class="token punctuation">,</span> MessageRole</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> ChatPromptTemplate</span>
<span class="line"></span>
<span class="line">chat_text_qa_msgs <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    ChatMessage<span class="token punctuation">(</span></span>
<span class="line">        role<span class="token operator">=</span>MessageRole<span class="token punctuation">.</span>SYSTEM<span class="token punctuation">,</span></span>
<span class="line">        content<span class="token operator">=</span><span class="token string">&quot;ä½ å«{name}ï¼Œä½ å¿…é¡»æ ¹æ®ç”¨æˆ·æä¾›çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    ChatMessage<span class="token punctuation">(</span></span>
<span class="line">        role<span class="token operator">=</span>MessageRole<span class="token punctuation">.</span>USER<span class="token punctuation">,</span> </span>
<span class="line">        content<span class="token operator">=</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;å·²çŸ¥ä¸Šä¸‹æ–‡ï¼š\n&quot;</span> \</span>
<span class="line">            <span class="token string">&quot;{context}\n\n&quot;</span> \</span>
<span class="line">            <span class="token string">&quot;é—®é¢˜ï¼š{question}&quot;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">text_qa_template <span class="token operator">=</span> ChatPromptTemplate<span class="token punctuation">(</span>chat_text_qa_msgs<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span></span>
<span class="line">    text_qa_template<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;ç“œç“œ&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        context<span class="token operator">=</span><span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        question<span class="token operator">=</span><span class="token string">&quot;è¿™æ˜¯ä»€ä¹ˆ&quot;</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">system: ä½ å«ç“œç“œï¼Œä½ å¿…é¡»æ ¹æ®ç”¨æˆ·æä¾›çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚</span>
<span class="line">user: å·²çŸ¥ä¸Šä¸‹æ–‡ï¼š</span>
<span class="line">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•</span>
<span class="line"></span>
<span class="line">é—®é¢˜ï¼šè¿™æ˜¯ä»€ä¹ˆ</span>
<span class="line">assistant:</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2ã€è¯­è¨€æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_7-2ã€è¯­è¨€æ¨¡å‹"><span>7.2ã€è¯­è¨€æ¨¡å‹</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>llms<span class="token punctuation">.</span>openai <span class="token keyword">import</span> OpenAI</span>
<span class="line"></span>
<span class="line">llm <span class="token operator">=</span> OpenAI<span class="token punctuation">(</span>temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">&quot;gpt-4o&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">response <span class="token operator">=</span> llm<span class="token punctuation">.</span>complete<span class="token punctuation">(</span>prompt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>topic<span class="token operator">=</span><span class="token string">&quot;å°æ˜&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">å°æ˜æœ‰ä¸€å¤©å»å‚åŠ ä¸€ä¸ªæ™ºåŠ›ç«èµ›ï¼Œä¸»æŒäººé—®ä»–ï¼šâ€œå°æ˜ï¼Œè¯·ç”¨â€˜å› ä¸ºâ€™å’Œâ€˜æ‰€ä»¥â€™é€ ä¸€ä¸ªå¥å­ã€‚â€</span>
<span class="line"></span>
<span class="line">å°æ˜æƒ³äº†æƒ³ï¼Œè¯´ï¼šâ€œå› ä¸ºä»Šå¤©æˆ‘æ²¡å¸¦ä½œä¸šï¼Œæ‰€ä»¥æˆ‘æ¥å‚åŠ æ¯”èµ›äº†ã€‚â€</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">response <span class="token operator">=</span> llm<span class="token punctuation">.</span>complete<span class="token punctuation">(</span></span>
<span class="line">    text_qa_template<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;ç“œç“œ&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        context<span class="token operator">=</span><span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        question<span class="token operator">=</span><span class="token string">&quot;ä½ æ˜¯è°ï¼Œæˆ‘ä»¬åœ¨å¹²å˜›&quot;</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">æˆ‘æ˜¯ç“œç“œï¼Œä½ çš„æ™ºèƒ½åŠ©æ‰‹ã€‚æ ¹æ®ä½ æä¾›çš„ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬æ­£åœ¨è¿›è¡Œä¸€ä¸ªæµ‹è¯•ã€‚è¯·è®©æˆ‘çŸ¥é“å¦‚æœä½ æœ‰å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="è®¾ç½®å…¨å±€ä½¿ç”¨çš„è¯­è¨€æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®å…¨å±€ä½¿ç”¨çš„è¯­è¨€æ¨¡å‹"><span>è®¾ç½®å…¨å±€ä½¿ç”¨çš„è¯­è¨€æ¨¡å‹</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> Settings</span>
<span class="line"></span>
<span class="line">Settings<span class="token punctuation">.</span>llm <span class="token operator">=</span> OpenAI<span class="token punctuation">(</span>temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">&quot;gpt-4o&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤ OpenAI å¤–ï¼ŒLlamaIndex å·²é›†æˆå¤šä¸ªå¤§è¯­è¨€æ¨¡å‹ï¼ŒåŒ…æ‹¬äº‘æœåŠ¡ API å’Œæœ¬åœ°éƒ¨ç½² APIï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.llamaindex.ai/en/stable/module_guides/models/llms/modules/" target="_blank" rel="noopener noreferrer">Available LLM integrations</a></p><h3 id="_7-3ã€embedding-æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_7-3ã€embedding-æ¨¡å‹"><span>7.3ã€Embedding æ¨¡å‹</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>openai <span class="token keyword">import</span> OpenAIEmbedding</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> Settings</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å…¨å±€è®¾å®š</span></span>
<span class="line">Settings<span class="token punctuation">.</span>embed_model <span class="token operator">=</span> OpenAIEmbedding<span class="token punctuation">(</span>model<span class="token operator">=</span><span class="token string">&quot;text-embedding-3-small&quot;</span><span class="token punctuation">,</span> dimensions<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>LlamaIndex åŒæ ·é›†æˆäº†å¤šç§ Embedding æ¨¡å‹ï¼ŒåŒ…æ‹¬äº‘æœåŠ¡ API å’Œå¼€æºæ¨¡å‹ï¼ˆHuggingFaceï¼‰ç­‰ï¼Œè¯¦è§<a href="https://docs.llamaindex.ai/en/stable/module_guides/models/embeddings/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h2 id="_8ã€åŸºäº-llamaindex-å®ç°ä¸€ä¸ªåŠŸèƒ½è¾ƒå®Œæ•´çš„-rag-ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_8ã€åŸºäº-llamaindex-å®ç°ä¸€ä¸ªåŠŸèƒ½è¾ƒå®Œæ•´çš„-rag-ç³»ç»Ÿ"><span>8ã€åŸºäº LlamaIndex å®ç°ä¸€ä¸ªåŠŸèƒ½è¾ƒå®Œæ•´çš„ RAG ç³»ç»Ÿ</span></a></h2><p>åŠŸèƒ½è¦æ±‚ï¼š</p><ul><li>åŠ è½½æŒ‡å®šç›®å½•çš„æ–‡ä»¶</li><li>æ”¯æŒ RAG-Fusion</li><li>ä½¿ç”¨ Qdrant å‘é‡æ•°æ®åº“ï¼Œå¹¶æŒä¹…åŒ–åˆ°æœ¬åœ°</li><li>æ”¯æŒæ£€ç´¢åæ’åº</li><li>æ”¯æŒå¤šè½®å¯¹è¯</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> qdrant_client <span class="token keyword">import</span> QdrantClient</span>
<span class="line"><span class="token keyword">from</span> qdrant_client<span class="token punctuation">.</span>models <span class="token keyword">import</span> VectorParams<span class="token punctuation">,</span> Distance</span>
<span class="line"></span>
<span class="line">EMBEDDING_DIM <span class="token operator">=</span> <span class="token number">512</span></span>
<span class="line">COLLECTION_NAME <span class="token operator">=</span> <span class="token string">&quot;full_demo&quot;</span></span>
<span class="line">PATH <span class="token operator">=</span> <span class="token string">&quot;./qdrant_db&quot;</span></span>
<span class="line"></span>
<span class="line">client <span class="token operator">=</span> QdrantClient<span class="token punctuation">(</span>path<span class="token operator">=</span>PATH<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> VectorStoreIndex<span class="token punctuation">,</span> KeywordTableIndex<span class="token punctuation">,</span> SimpleDirectoryReader</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>vector_stores<span class="token punctuation">.</span>qdrant <span class="token keyword">import</span> QdrantVectorStore</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>node_parser <span class="token keyword">import</span> SentenceSplitter</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ingestion <span class="token keyword">import</span> IngestionPipeline</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>readers<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token keyword">import</span> PyMuPDFReader</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> Settings</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core <span class="token keyword">import</span> StorageContext</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>postprocessor <span class="token keyword">import</span> SentenceTransformerRerank</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>retrievers <span class="token keyword">import</span> QueryFusionRetriever</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query_engine <span class="token keyword">import</span> RetrieverQueryEngine</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>core<span class="token punctuation">.</span>chat_engine <span class="token keyword">import</span> CondenseQuestionChatEngine</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>llms<span class="token punctuation">.</span>openai <span class="token keyword">import</span> OpenAI</span>
<span class="line"><span class="token keyword">from</span> llama_index<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>openai <span class="token keyword">import</span> OpenAIEmbedding</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 1. æŒ‡å®šå…¨å±€llmä¸embeddingæ¨¡å‹</span></span>
<span class="line">Settings<span class="token punctuation">.</span>llm <span class="token operator">=</span> OpenAI<span class="token punctuation">(</span>temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">&quot;gpt-4o&quot;</span><span class="token punctuation">)</span></span>
<span class="line">Settings<span class="token punctuation">.</span>embed_model <span class="token operator">=</span> OpenAIEmbedding<span class="token punctuation">(</span>model<span class="token operator">=</span><span class="token string">&quot;text-embedding-3-small&quot;</span><span class="token punctuation">,</span> dimensions<span class="token operator">=</span>EMBEDDING_DIM<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 2. æŒ‡å®šå…¨å±€æ–‡æ¡£å¤„ç†çš„ Ingestion Pipeline</span></span>
<span class="line">Settings<span class="token punctuation">.</span>transformations <span class="token operator">=</span> <span class="token punctuation">[</span>SentenceSplitter<span class="token punctuation">(</span>chunk_size<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> chunk_overlap<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. åŠ è½½æœ¬åœ°æ–‡æ¡£</span></span>
<span class="line">documents <span class="token operator">=</span> SimpleDirectoryReader<span class="token punctuation">(</span><span class="token string">&quot;./data&quot;</span><span class="token punctuation">,</span> file_extractor<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;.pdf&quot;</span><span class="token punctuation">:</span> PyMuPDFReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> client<span class="token punctuation">.</span>collection_exists<span class="token punctuation">(</span>collection_name<span class="token operator">=</span>COLLECTION_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    client<span class="token punctuation">.</span>delete_collection<span class="token punctuation">(</span>collection_name<span class="token operator">=</span>COLLECTION_NAME<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. åˆ›å»º collection</span></span>
<span class="line">client<span class="token punctuation">.</span>create_collection<span class="token punctuation">(</span></span>
<span class="line">    collection_name<span class="token operator">=</span>COLLECTION_NAME<span class="token punctuation">,</span></span>
<span class="line">    vectors_config<span class="token operator">=</span>VectorParams<span class="token punctuation">(</span>size<span class="token operator">=</span>EMBEDDING_DIM<span class="token punctuation">,</span> distance<span class="token operator">=</span>Distance<span class="token punctuation">.</span>COSINE<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 5. åˆ›å»º Vector Store</span></span>
<span class="line">vector_store <span class="token operator">=</span> QdrantVectorStore<span class="token punctuation">(</span>client<span class="token operator">=</span>client<span class="token punctuation">,</span> collection_name<span class="token operator">=</span>COLLECTION_NAME<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 6. æŒ‡å®š Vector Store çš„ Storage ç”¨äº index</span></span>
<span class="line">storage_context <span class="token operator">=</span> StorageContext<span class="token punctuation">.</span>from_defaults<span class="token punctuation">(</span>vector_store<span class="token operator">=</span>vector_store<span class="token punctuation">)</span></span>
<span class="line">index <span class="token operator">=</span> VectorStoreIndex<span class="token punctuation">.</span>from_documents<span class="token punctuation">(</span></span>
<span class="line">    documents<span class="token punctuation">,</span> storage_context<span class="token operator">=</span>storage_context</span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 7. å®šä¹‰æ£€ç´¢åæ’åºæ¨¡å‹</span></span>
<span class="line">reranker <span class="token operator">=</span> SentenceTransformerRerank<span class="token punctuation">(</span></span>
<span class="line">    model<span class="token operator">=</span><span class="token string">&quot;BAAI/bge-reranker-large&quot;</span><span class="token punctuation">,</span> top_n<span class="token operator">=</span><span class="token number">2</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 8. å®šä¹‰ RAG Fusion æ£€ç´¢å™¨</span></span>
<span class="line">fusion_retriever <span class="token operator">=</span> QueryFusionRetriever<span class="token punctuation">(</span></span>
<span class="line">    <span class="token punctuation">[</span>index<span class="token punctuation">.</span>as_retriever<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    similarity_top_k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment"># æ£€ç´¢å¬å› top k ç»“æœ</span></span>
<span class="line">    num_queries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># ç”Ÿæˆ query æ•°</span></span>
<span class="line">    use_async<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token comment"># query_gen_prompt=&quot;...&quot;,  # å¯ä»¥è‡ªå®šä¹‰ query ç”Ÿæˆçš„ prompt æ¨¡æ¿</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 9. æ„å»ºå•è½® query engine</span></span>
<span class="line">query_engine <span class="token operator">=</span> RetrieverQueryEngine<span class="token punctuation">.</span>from_args<span class="token punctuation">(</span></span>
<span class="line">    fusion_retriever<span class="token punctuation">,</span></span>
<span class="line">    node_postprocessors<span class="token operator">=</span><span class="token punctuation">[</span>reranker<span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 10. å¯¹è¯å¼•æ“</span></span>
<span class="line">chat_engine <span class="token operator">=</span> CondenseQuestionChatEngine<span class="token punctuation">.</span>from_defaults<span class="token punctuation">(</span></span>
<span class="line">    query_engine<span class="token operator">=</span>query_engine<span class="token punctuation">,</span> </span>
<span class="line">    <span class="token comment"># condense_question_prompt=... # å¯ä»¥è‡ªå®šä¹‰ chat message prompt æ¨¡æ¿</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">    question<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;User:&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> question<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line">    response <span class="token operator">=</span> chat_engine<span class="token punctuation">.</span>chat<span class="token punctuation">(</span>question<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;AI: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Output:</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">User: llama2æœ‰å¤šå°‘å‚æ•°</span>
<span class="line">AI: Llama 2 æœ‰ 7Bã€13B å’Œ 70B å‚æ•°çš„å˜ä½“ã€‚</span>
<span class="line">User: æœ€å¤šå¤šå°‘</span>
<span class="line">AI: Llama 2 çš„å˜ä½“ä¸­å‚æ•°æœ€å¤šçš„æ˜¯ 70Bã€‚</span>
<span class="line">User:</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="llamaindex-çš„æ›´å¤šåŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#llamaindex-çš„æ›´å¤šåŠŸèƒ½"><span>LlamaIndex çš„æ›´å¤šåŠŸèƒ½</span></a></h2><ul><li>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å¼€å‘æ¡†æ¶ï¼šhttps://docs.llamaindex.ai/en/stable/module_guides/deploying/agents/</li><li>RAG çš„è¯„æµ‹ï¼šhttps://docs.llamaindex.ai/en/stable/module_guides/evaluating/</li><li>è¿‡ç¨‹ç›‘æ§ï¼šhttps://docs.llamaindex.ai/en/stable/module_guides/observability/</li></ul><p>ä»¥ä¸Šå†…å®¹æ¶‰åŠè¾ƒå¤šèƒŒæ™¯çŸ¥è¯†ï¼Œæš‚æ—¶ä¸åœ¨æœ¬è¯¾å±•å¼€ï¼Œç›¸å…³çŸ¥è¯†ä¼šåœ¨åé¢è¯¾ç¨‹ä¸­é€ä¸€è¯¦ç»†è®²è§£ã€‚</p><p>æ­¤å¤–ï¼ŒLlamaIndex é’ˆå¯¹ç”Ÿäº§çº§çš„ RAG ç³»ç»Ÿä¸­é‡åˆ°çš„å„ä¸ªæ–¹é¢çš„ç»†èŠ‚é—®é¢˜ï¼Œæ€»ç»“äº†å¾ˆå¤šé«˜ç«¯æŠ€å·§ï¼ˆ<a href="https://docs.llamaindex.ai/en/stable/optimizing/production_rag/" target="_blank" rel="noopener noreferrer">Advanced Topics</a>ï¼‰ï¼Œå¯¹å®æˆ˜å¾ˆæœ‰å‚è€ƒä»·å€¼ï¼Œéå¸¸æ¨èæœ‰èƒ½åŠ›çš„åŒå­¦é˜…è¯»ã€‚</p><h2 id="ä½œä¸š" tabindex="-1"><a class="header-anchor" href="#ä½œä¸š"><span>ä½œä¸š</span></a></h2><ol><li>åŸºäº LlamaIndex å®ç°ä¸€ä¸ªè‡ªå·± RAG ç³»ç»Ÿã€‚</li><li>æŸ¥é˜… LlamaIndex æ–‡æ¡£å’Œç½‘ä¸Šç›¸å…³èµ„æ–™ï¼Œæ€è€ƒå¦‚ä½•è®©ç¬¬ 8 èŠ‚ä¸­çš„ç³»ç»Ÿæ”¯æŒå…³é”®å­—ä¸å‘é‡çš„æ··åˆæ£€ç´¢ï¼ˆé€‰ï¼‰</li></ol></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script src="/wiki/assets/js/runtime~app.d314b252.js" defer></script><script src="/wiki/assets/js/768.e6d4205d.js" defer></script><script src="/wiki/assets/js/app.7c5dba0b.js" defer></script>
  </body>
</html>
